"use strict";(self.webpackChunkkeep_being_human_dev=self.webpackChunkkeep_being_human_dev||[]).push([[13841],{65404:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>p});var a=t(36672);const i={},o=a.createContext(i);function r(e){const n=a.useContext(o);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function p(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),a.createElement(o.Provider,{value:n},e.children)}},88294:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>p,default:()=>m,frontMatter:()=>r,metadata:()=>a,toc:()=>s});const a=JSON.parse('{"id":"gems/mini_magick/expert/pdf_multipage_annotation","title":"pdf_multipage_annotation","description":"\ud83d\udcc4 Complex Multi-Page PDF Annotation and Extraction","source":"@site/docs/gems/mini_magick/expert/pdf_multipage_annotation.md","sourceDirName":"gems/mini_magick/expert","slug":"/gems/mini_magick/expert/pdf_multipage_annotation","permalink":"/keep-being-human-dev/docs/gems/mini_magick/expert/pdf_multipage_annotation","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/gems/mini_magick/expert/pdf_multipage_annotation.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"gif_optimization_pipeline","permalink":"/keep-being-human-dev/docs/gems/mini_magick/expert/gif_optimization_pipeline"},"next":{"title":"streaming_image_pipelining","permalink":"/keep-being-human-dev/docs/gems/mini_magick/expert/streaming_image_pipelining"}}');var i=t(23420),o=t(65404);const r={},p=void 0,c={},s=[{value:"\ud83d\udcc4 Complex Multi-Page PDF Annotation and Extraction",id:"-complex-multi-page-pdf-annotation-and-extraction",level:2}];function d(e){const n={code:"code",h2:"h2",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"-complex-multi-page-pdf-annotation-and-extraction",children:"\ud83d\udcc4 Complex Multi-Page PDF Annotation and Extraction"}),"\n",(0,i.jsx)(n.p,{children:"Leverage MiniMagick\u2019s page-level API to annotate each PDF page with dynamic headers or footers, then extract subregions for targeted exports. This approach automates watermarking, custom numbering, and selective cropping in large documents\u2014ideal for batch report generation."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ruby",children:"require 'mini_magick'\n\npdf = MiniMagick::Image.open('source.pdf')\ntotal = pdf.pages.count\n\npdf.pages.each_with_index do |page, idx|\n  # Annotate header on each page\n  page.combine_options do |cmd|\n    cmd.density 300\n    cmd.font 'Helvetica'\n    cmd.pointsize 20\n    cmd.draw \"text 50,50 'Page #{idx+1} of #{total}'\"\n  end\n  page.write(\"annotated_#{idx+1}.pdf\")\nend\n\n# Recombine annotated pages\nMiniMagick::Tool::Convert.new do |convert|\n  Dir['annotated_*.pdf'].sort.each { |f| convert << f }\n  convert << 'final_annotated.pdf'\nend\n"})}),"\n",(0,i.jsx)(n.p,{children:"You can also crop a signature box from page 3:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ruby",children:"signature = pdf.pages[2]\nsignature.crop '200x100+400+300'\nsignature.write('signature_crop.png')\n"})})]})}function m(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);