"use strict";(self.webpackChunkkeep_being_human_dev=self.webpackChunkkeep_being_human_dev||[]).push([[14843],{20948:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>c,contentTitle:()=>i,default:()=>p,frontMatter:()=>o,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"rails/active_record/expert/arel_complex_predicates","title":"arel_complex_predicates","description":"\ud83d\ude80 Deep Arel Predicates for Complex Queries","source":"@site/docs/rails/active_record/expert/arel_complex_predicates.md","sourceDirName":"rails/active_record/expert","slug":"/rails/active_record/expert/arel_complex_predicates","permalink":"/keep-being-human-dev/docs/rails/active_record/expert/arel_complex_predicates","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/rails/active_record/expert/arel_complex_predicates.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"advanced_eager_loading","permalink":"/keep-being-human-dev/docs/rails/active_record/expert/advanced_eager_loading"},"next":{"title":"association_cache_bidi","permalink":"/keep-being-human-dev/docs/rails/active_record/expert/association_cache_bidi"}}');var a=t(23420),n=t(65404);const o={},i=void 0,c={},d=[{value:"\ud83d\ude80 Deep Arel Predicates for Complex Queries",id:"-deep-arel-predicates-for-complex-queries",level:2}];function l(e){const r={code:"code",h2:"h2",p:"p",pre:"pre",...(0,n.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.h2,{id:"-deep-arel-predicates-for-complex-queries",children:"\ud83d\ude80 Deep Arel Predicates for Complex Queries"}),"\n",(0,a.jsx)(r.p,{children:"Leverage Arel to build dynamic, composable SQL fragments beyond what ActiveRecord relations expose. This lets you integrate raw SQL constructs (CTEs, lateral joins) seamlessly into your Rails codebase."}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-ruby",children:"users = User.arel_table\noverdue_invoices = Invoice.arel_table\n\ncte = Arel::Nodes::As.new(\n  Arel.sql('overdue_invoices'),\n  overdue_invoices.project(Arel.star).where(\n    overdue_invoices[:due_date].lt(Date.today)\n  )\n)\n\nquery = User.with(cte)\n            .joins(\"JOIN overdue_invoices ON overdue_invoices.user_id = users.id\")\n            .where(users[:active].eq(true))\n\nUser.find_by_sql(query.to_sql)\n"})})]})}function p(e={}){const{wrapper:r}={...(0,n.R)(),...e.components};return r?(0,a.jsx)(r,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},65404:(e,r,t)=>{t.d(r,{R:()=>o,x:()=>i});var s=t(36672);const a={},n=s.createContext(a);function o(e){const r=s.useContext(n);return s.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function i(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),s.createElement(n.Provider,{value:r},e.children)}}}]);