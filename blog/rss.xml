<?xml version="1.0" encoding="utf-8"?><?xml-stylesheet type="text/xsl" href="rss.xsl"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title>My Site Blog</title>
        <link>https://ojisanchamchi.github.io/keep-being-human-dev/blog/</link>
        <description>My Site Blog</description>
        <lastBuildDate>Thu, 24 Jul 2025 03:14:55 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>en</language>
        <item>
            <title><![CDATA[Hướng Dẫn Toàn Diện Về Benchmark Trong Ruby - Từ Cơ Bản Đến Chuyên Sâu]]></title>
            <link>https://ojisanchamchi.github.io/keep-being-human-dev/blog/huong-dan-benchmark-ruby/</link>
            <guid>https://ojisanchamchi.github.io/keep-being-human-dev/blog/huong-dan-benchmark-ruby/</guid>
            <pubDate>Thu, 24 Jul 2025 03:14:55 GMT</pubDate>
            <description><![CDATA[Tối ưu hóa hiệu suất là một khía cạnh quan trọng trong phát triển Ruby, cho dù bạn đang xây dựng ứng dụng web, hệ thống xử lý dữ liệu, hay công cụ dòng lệnh. Hướng dẫn toàn diện này sẽ giúp bạn khám phá các khả năng benchmark của Ruby, từ đo lường thời gian cơ bản đến các kỹ thuật phân tích chuyên sâu. Đến cuối bài, bạn sẽ có một bộ công cụ đầy đủ để đo lường, so sánh và tối ưu hóa mã Ruby của mình.]]></description>
            <content:encoded><![CDATA[<p>Tối ưu hóa hiệu suất là một khía cạnh quan trọng trong phát triển Ruby, cho dù bạn đang xây dựng ứng dụng web, hệ thống xử lý dữ liệu, hay công cụ dòng lệnh. Hướng dẫn toàn diện này sẽ giúp bạn khám phá các khả năng benchmark của Ruby, từ đo lường thời gian cơ bản đến các kỹ thuật phân tích chuyên sâu. Đến cuối bài, bạn sẽ có một bộ công cụ đầy đủ để đo lường, so sánh và tối ưu hóa mã Ruby của mình.</p>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="cấp-độ-cơ-bản-bắt-đầu-với-ruby-benchmarking">Cấp Độ Cơ Bản: Bắt Đầu Với Ruby Benchmarking<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/huong-dan-benchmark-ruby/#c%E1%BA%A5p-%C4%91%E1%BB%99-c%C6%A1-b%E1%BA%A3n-b%E1%BA%AFt-%C4%91%E1%BA%A7u-v%E1%BB%9Bi-ruby-benchmarking" class="hash-link" aria-label="Direct link to Cấp Độ Cơ Bản: Bắt Đầu Với Ruby Benchmarking" title="Direct link to Cấp Độ Cơ Bản: Bắt Đầu Với Ruby Benchmarking">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_aa2m" id="-kiểm-tra-hiệu-suất-nhanh-trong-irb-hoặc-rails-console">⚡ Kiểm Tra Hiệu Suất Nhanh Trong IRB hoặc Rails Console<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/huong-dan-benchmark-ruby/#-ki%E1%BB%83m-tra-hi%E1%BB%87u-su%E1%BA%A5t-nhanh-trong-irb-ho%E1%BA%B7c-rails-console" class="hash-link" aria-label="Direct link to ⚡ Kiểm Tra Hiệu Suất Nhanh Trong IRB hoặc Rails Console" title="Direct link to ⚡ Kiểm Tra Hiệu Suất Nhanh Trong IRB hoặc Rails Console">​</a></h3>
<p>Cách đơn giản nhất để bắt đầu benchmark là trực tiếp trong môi trường Ruby tương tác. Thư viện chuẩn của Ruby bao gồm module <code>Benchmark</code>, cung cấp nhiều phương thức để đo thời gian thực thi mã.</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ irb</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">require</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'benchmark'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> Benchmark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">measure </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1.</span><span class="token number" style="color:rgb(181, 206, 168)">.100</span><span class="token plain">_000</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">map</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token symbol">:to_s</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain">   </span><span class="token number" style="color:rgb(181, 206, 168)">0.020000</span><span class="token plain">   </span><span class="token number" style="color:rgb(181, 206, 168)">0.000000</span><span class="token plain">   </span><span class="token number" style="color:rgb(181, 206, 168)">0.020000</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">  </span><span class="token number" style="color:rgb(181, 206, 168)">0.019845</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><br></span></code></pre></div></div>
<p>Kết quả này hiển thị thời gian CPU người dùng, thời gian CPU hệ thống, tổng thời gian CPU và thời gian thực tế trôi qua (trong ngoặc đơn).</p>
<h3 class="anchor anchorWithStickyNavbar_aa2m" id="-sử-dụng-benchmarkmeasure-để-đo-thời-gian-nhanh">🕒 Sử Dụng Benchmark.measure Để Đo Thời Gian Nhanh<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/huong-dan-benchmark-ruby/#-s%E1%BB%AD-d%E1%BB%A5ng-benchmarkmeasure-%C4%91%E1%BB%83-%C4%91o-th%E1%BB%9Di-gian-nhanh" class="hash-link" aria-label="Direct link to 🕒 Sử Dụng Benchmark.measure Để Đo Thời Gian Nhanh" title="Direct link to 🕒 Sử Dụng Benchmark.measure Để Đo Thời Gian Nhanh">​</a></h3>
<p>Khi bạn muốn đo thời gian của một khối mã cụ thể trong script của mình, <code>Benchmark.measure</code> là phương thức lý tưởng:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">require</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'benchmark'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">time </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Benchmark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">measure </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># mã của bạn ở đây</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token number" style="color:rgb(181, 206, 168)">100</span><span class="token plain">_000</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">times </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">i</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> i </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">puts time  </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt;   0.010000   0.000000   0.010000 (  0.009876)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_aa2m" id="️-đo-lường-ruby-thuần-túy-với-benchmarkrealtime">⏱️ Đo Lường Ruby Thuần Túy Với Benchmark.realtime<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/huong-dan-benchmark-ruby/#%EF%B8%8F-%C4%91o-l%C6%B0%E1%BB%9Dng-ruby-thu%E1%BA%A7n-t%C3%BAy-v%E1%BB%9Bi-benchmarkrealtime" class="hash-link" aria-label="Direct link to ⏱️ Đo Lường Ruby Thuần Túy Với Benchmark.realtime" title="Direct link to ⏱️ Đo Lường Ruby Thuần Túy Với Benchmark.realtime">​</a></h3>
<p>Nếu bạn chỉ quan tâm đến thời gian thực tế (thời gian thực sự mất để thực hiện một tác vụ), <code>Benchmark.realtime</code> cung cấp giao diện đơn giản hơn:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">require</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'benchmark'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">elapsed </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Benchmark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">realtime </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  sleep </span><span class="token number" style="color:rgb(181, 206, 168)">0.5</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># thay thế bằng logic của bạn</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">puts </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Thời gian đã trôi qua: </span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">#{</span><span class="token string-literal interpolation content">elapsed</span><span class="token string-literal interpolation content punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string-literal interpolation content">round</span><span class="token string-literal interpolation content punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal interpolation content number" style="color:rgb(181, 206, 168)">3</span><span class="token string-literal interpolation content punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-literal string" style="color:rgb(206, 145, 120)"> giây"</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_aa2m" id="-so-sánh-nhiều-đoạn-mã-với-benchmarkbm">📊 So Sánh Nhiều Đoạn Mã Với Benchmark.bm<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/huong-dan-benchmark-ruby/#-so-s%C3%A1nh-nhi%E1%BB%81u-%C4%91o%E1%BA%A1n-m%C3%A3-v%E1%BB%9Bi-benchmarkbm" class="hash-link" aria-label="Direct link to 📊 So Sánh Nhiều Đoạn Mã Với Benchmark.bm" title="Direct link to 📊 So Sánh Nhiều Đoạn Mã Với Benchmark.bm">​</a></h3>
<p>Khi bạn cần so sánh các cách triển khai khác nhau, <code>Benchmark.bm</code> tạo ra một bảng định dạng:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">require</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'benchmark'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Benchmark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">bm</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">12</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">x</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  x</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">report</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"vòng lặp times"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain">_000_000</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">times </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">i</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> i </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  x</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">report</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"vòng lặp for  "</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">for</span><span class="token plain"> i </span><span class="token keyword" style="color:rgb(86, 156, 214)">in</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1.</span><span class="token number" style="color:rgb(181, 206, 168)">.1</span><span class="token plain">_000_000</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      i </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><br></span></code></pre></div></div>
<p>Tham số <code>12</code> chỉ định độ rộng của cột nhãn để căn chỉnh.</p>
<h3 class="anchor anchorWithStickyNavbar_aa2m" id="-truy-cập-thời-gian-thực-người-dùng-và-hệ-thống-từ-tms">💾 Truy Cập Thời Gian Thực, Người Dùng và Hệ Thống từ Tms<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/huong-dan-benchmark-ruby/#-truy-c%E1%BA%ADp-th%E1%BB%9Di-gian-th%E1%BB%B1c-ng%C6%B0%E1%BB%9Di-d%C3%B9ng-v%C3%A0-h%E1%BB%87-th%E1%BB%91ng-t%E1%BB%AB-tms" class="hash-link" aria-label="Direct link to 💾 Truy Cập Thời Gian Thực, Người Dùng và Hệ Thống từ Tms" title="Direct link to 💾 Truy Cập Thời Gian Thực, Người Dùng và Hệ Thống từ Tms">​</a></h3>
<p>Phương thức <code>Benchmark.measure</code> trả về một đối tượng <code>Benchmark::Tms</code> với các thuộc tính thời gian riêng biệt:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">require</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'benchmark'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">t </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Benchmark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">measure </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token plain">_000</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">times </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> Math</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">sqrt</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">123.456</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">puts </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Thực: </span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">#{</span><span class="token string-literal interpolation content">t</span><span class="token string-literal interpolation content punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string-literal interpolation content">real</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"</span><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># thời gian thực tế</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">puts </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Người dùng: </span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">#{</span><span class="token string-literal interpolation content">t</span><span class="token string-literal interpolation content punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string-literal interpolation content">utime</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"</span><span class="token plain">   </span><span class="token comment" style="color:rgb(106, 153, 85)"># thời gian CPU dành cho Ruby</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">puts </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Hệ thống: </span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">#{</span><span class="token string-literal interpolation content">t</span><span class="token string-literal interpolation content punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string-literal interpolation content">stime</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)"># thời gian CPU dành cho lệnh gọi hệ thống</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="cấp-độ-trung-cấp-đo-lường-chính-xác-hơn">Cấp Độ Trung Cấp: Đo Lường Chính Xác Hơn<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/huong-dan-benchmark-ruby/#c%E1%BA%A5p-%C4%91%E1%BB%99-trung-c%E1%BA%A5p-%C4%91o-l%C6%B0%E1%BB%9Dng-ch%C3%ADnh-x%C3%A1c-h%C6%A1n" class="hash-link" aria-label="Direct link to Cấp Độ Trung Cấp: Đo Lường Chính Xác Hơn" title="Direct link to Cấp Độ Trung Cấp: Đo Lường Chính Xác Hơn">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_aa2m" id="-sử-dụng-benchmarkbm-cho-các-phép-đo-chi-tiết">🚀 Sử Dụng Benchmark.bm Cho Các Phép Đo Chi Tiết<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/huong-dan-benchmark-ruby/#-s%E1%BB%AD-d%E1%BB%A5ng-benchmarkbm-cho-c%C3%A1c-ph%C3%A9p-%C4%91o-chi-ti%E1%BA%BFt" class="hash-link" aria-label="Direct link to 🚀 Sử Dụng Benchmark.bm Cho Các Phép Đo Chi Tiết" title="Direct link to 🚀 Sử Dụng Benchmark.bm Cho Các Phép Đo Chi Tiết">​</a></h3>
<p>Để so sánh chi tiết hơn, bạn có thể sử dụng <code>Benchmark.bm</code> với nhiều khối mã:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">require</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'benchmark'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">n </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">500</span><span class="token plain">_000</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Benchmark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">bm</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">x</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  x</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">report</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'each'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">each</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">i</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> Math</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">sqrt</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  x</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">report</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'map'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">     </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">map     </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">i</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> Math</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">sqrt</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  x</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">report</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'collect'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">collect </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">i</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> Math</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">sqrt</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_aa2m" id="-tận-dụng-benchmarkbmbm-cho-so-sánh-chính-xác">🧪 Tận Dụng Benchmark.bmbm Cho So Sánh Chính Xác<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/huong-dan-benchmark-ruby/#-t%E1%BA%ADn-d%E1%BB%A5ng-benchmarkbmbm-cho-so-s%C3%A1nh-ch%C3%ADnh-x%C3%A1c" class="hash-link" aria-label="Direct link to 🧪 Tận Dụng Benchmark.bmbm Cho So Sánh Chính Xác" title="Direct link to 🧪 Tận Dụng Benchmark.bmbm Cho So Sánh Chính Xác">​</a></h3>
<p>Phương thức <code>bmbm</code> (viết tắt của "benchmark benchmark") chạy mỗi khối hai lần—đầu tiên là "tập dượt" và sau đó là đo lường thực tế. Điều này giúp loại bỏ các bất thường trong lần chạy đầu tiên như JIT warm-up hoặc overhead của garbage collection:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">require</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'benchmark'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Benchmark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">bmbm</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">12</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">x</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  x</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">report</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'nối chuỗi +'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">     </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">100</span><span class="token plain">_000</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">times </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'a'</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">+</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'b'</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  x</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">report</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'nội suy chuỗi'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">100</span><span class="token plain">_000</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">times </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">#{</span><span class="token string-literal interpolation content">a</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">#{</span><span class="token string-literal interpolation content">b</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_aa2m" id="️-sử-dụng-benchmarkrealtime-cho-đo-thời-gian-nhanh">⏱️ Sử Dụng Benchmark.realtime Cho Đo Thời Gian Nhanh<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/huong-dan-benchmark-ruby/#%EF%B8%8F-s%E1%BB%AD-d%E1%BB%A5ng-benchmarkrealtime-cho-%C4%91o-th%E1%BB%9Di-gian-nhanh" class="hash-link" aria-label="Direct link to ⏱️ Sử Dụng Benchmark.realtime Cho Đo Thời Gian Nhanh" title="Direct link to ⏱️ Sử Dụng Benchmark.realtime Cho Đo Thời Gian Nhanh">​</a></h3>
<p>Đối với các phép đo nhanh, <code>Benchmark.realtime</code> là lựa chọn hoàn hảo:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">require</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'benchmark'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">start_time </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Benchmark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">realtime </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  sleep</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">puts </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Thao tác mất </span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">#{</span><span class="token string-literal interpolation content">start_time</span><span class="token string-literal interpolation content punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string-literal interpolation content">round</span><span class="token string-literal interpolation content punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal interpolation content number" style="color:rgb(181, 206, 168)">3</span><span class="token string-literal interpolation content punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">s"</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_aa2m" id="-ghi-lại-và-định-dạng-kết-quả-benchmark">📊 Ghi Lại và Định Dạng Kết Quả Benchmark<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/huong-dan-benchmark-ruby/#-ghi-l%E1%BA%A1i-v%C3%A0-%C4%91%E1%BB%8Bnh-d%E1%BA%A1ng-k%E1%BA%BFt-qu%E1%BA%A3-benchmark" class="hash-link" aria-label="Direct link to 📊 Ghi Lại và Định Dạng Kết Quả Benchmark" title="Direct link to 📊 Ghi Lại và Định Dạng Kết Quả Benchmark">​</a></h3>
<p>Bạn có thể ghi lại kết quả benchmark và định dạng chúng theo chương trình:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">require</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'benchmark'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">result </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Benchmark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">measure </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain">_000_000</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">times </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">i</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> i</span><span class="token operator" style="color:rgb(212, 212, 212)">**</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">puts </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Thực: </span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">#{</span><span class="token string-literal interpolation content">result</span><span class="token string-literal interpolation content punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string-literal interpolation content">real</span><span class="token string-literal interpolation content punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string-literal interpolation content">round</span><span class="token string-literal interpolation content punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal interpolation content number" style="color:rgb(181, 206, 168)">4</span><span class="token string-literal interpolation content punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">s, Người dùng: </span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">#{</span><span class="token string-literal interpolation content">result</span><span class="token string-literal interpolation content punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string-literal interpolation content">utime</span><span class="token string-literal interpolation content punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string-literal interpolation content">round</span><span class="token string-literal interpolation content punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal interpolation content number" style="color:rgb(181, 206, 168)">4</span><span class="token string-literal interpolation content punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">s, Hệ thống: </span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">#{</span><span class="token string-literal interpolation content">result</span><span class="token string-literal interpolation content punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string-literal interpolation content">stime</span><span class="token string-literal interpolation content punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string-literal interpolation content">round</span><span class="token string-literal interpolation content punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal interpolation content number" style="color:rgb(181, 206, 168)">4</span><span class="token string-literal interpolation content punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">s"</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_aa2m" id="️-so-sánh-nối-chuỗi-và-nội-suy-chuỗi">✂️ So Sánh Nối Chuỗi và Nội Suy Chuỗi<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/huong-dan-benchmark-ruby/#%EF%B8%8F-so-s%C3%A1nh-n%E1%BB%91i-chu%E1%BB%97i-v%C3%A0-n%E1%BB%99i-suy-chu%E1%BB%97i" class="hash-link" aria-label="Direct link to ✂️ So Sánh Nối Chuỗi và Nội Suy Chuỗi" title="Direct link to ✂️ So Sánh Nối Chuỗi và Nội Suy Chuỗi">​</a></h3>
<p>Một ví dụ thực tế về benchmark các cách tiếp cận khác nhau:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">require</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'benchmark'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">n </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">200</span><span class="token plain">_000</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Benchmark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">bm</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">15</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">x</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  x</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">report</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'nối chuỗi'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> n</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">times </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'foo'</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">+</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'bar'</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  x</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">report</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'nội suy chuỗi'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> n</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">times </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">#{</span><span class="token string-literal interpolation content string-literal string" style="color:rgb(206, 145, 120)">'foo'</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">#{</span><span class="token string-literal interpolation content string-literal string" style="color:rgb(206, 145, 120)">'bar'</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="cấp-độ-nâng-cao-kỹ-thuật-benchmark-chuyên-biệt">Cấp Độ Nâng Cao: Kỹ Thuật Benchmark Chuyên Biệt<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/huong-dan-benchmark-ruby/#c%E1%BA%A5p-%C4%91%E1%BB%99-n%C3%A2ng-cao-k%E1%BB%B9-thu%E1%BA%ADt-benchmark-chuy%C3%AAn-bi%E1%BB%87t" class="hash-link" aria-label="Direct link to Cấp Độ Nâng Cao: Kỹ Thuật Benchmark Chuyên Biệt" title="Direct link to Cấp Độ Nâng Cao: Kỹ Thuật Benchmark Chuyên Biệt">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_aa2m" id="-sử-dụng-benchmark-ips-cho-các-số-liệu-thông-lượng">⚡ Sử Dụng <code>benchmark-ips</code> Cho Các Số Liệu Thông Lượng<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/huong-dan-benchmark-ruby/#-s%E1%BB%AD-d%E1%BB%A5ng-benchmark-ips-cho-c%C3%A1c-s%E1%BB%91-li%E1%BB%87u-th%C3%B4ng-l%C6%B0%E1%BB%A3ng" class="hash-link" aria-label="Direct link to -sử-dụng-benchmark-ips-cho-các-số-liệu-thông-lượng" title="Direct link to -sử-dụng-benchmark-ips-cho-các-số-liệu-thông-lượng">​</a></h3>
<p>Gem <code>benchmark-ips</code> đo lường số lần lặp mỗi giây, thường hữu ích hơn thời gian thô khi so sánh các thuật toán:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">require</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'benchmark/ips'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Benchmark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">ips </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">x</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  x</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">report</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'nối chuỗi'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">   </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'hello'</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">+</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">' '</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">+</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'world'</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  x</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">report</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'nội suy chuỗi'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">#{</span><span class="token string-literal interpolation content string-literal string" style="color:rgb(206, 145, 120)">'hello'</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-literal string" style="color:rgb(206, 145, 120)"> </span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">#{</span><span class="token string-literal interpolation content string-literal string" style="color:rgb(206, 145, 120)">'world'</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  x</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">compare</span><span class="token operator" style="color:rgb(212, 212, 212)">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><br></span></code></pre></div></div>
<p>Phương thức <code>compare!</code> tự động tính toán một cách triển khai nhanh hơn bao nhiêu so với các cách khác.</p>
<h3 class="anchor anchorWithStickyNavbar_aa2m" id="-mở-rộng-benchmarksuite-với-các-số-liệu-tùy-chỉnh">🔧 Mở Rộng <code>Benchmark::Suite</code> Với Các Số Liệu Tùy Chỉnh<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/huong-dan-benchmark-ruby/#-m%E1%BB%9F-r%E1%BB%99ng-benchmarksuite-v%E1%BB%9Bi-c%C3%A1c-s%E1%BB%91-li%E1%BB%87u-t%C3%B9y-ch%E1%BB%89nh" class="hash-link" aria-label="Direct link to -mở-rộng-benchmarksuite-với-các-số-liệu-tùy-chỉnh" title="Direct link to -mở-rộng-benchmarksuite-với-các-số-liệu-tùy-chỉnh">​</a></h3>
<p>Đối với phân tích đa chiều, bạn có thể tạo các bộ benchmark tùy chỉnh:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">require</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'benchmark/suite'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">CustomSuite</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain"> Benchmark</span><span class="token double-colon punctuation" style="color:rgb(212, 212, 212)">::</span><span class="token plain">Suite</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  report </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'allocations'</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">n</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token constant" style="color:rgb(100, 102, 149)">GC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">start</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"> before </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">GC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">stat</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token symbol">:total_allocated_objects</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    n</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">times </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">#{</span><span class="token string-literal interpolation content">rand</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token constant" style="color:rgb(100, 102, 149)">GC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">stat</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token symbol">:total_allocated_objects</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> before</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">suite </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">CustomSuite</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">new</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">suite</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">bench_ms</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token plain">_000</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">suite</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">print</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token symbol">:legacy</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_aa2m" id="-tạm-thời-vô-hiệu-hóa-garbage-collection-trong-benchmark">🚫 Tạm Thời Vô Hiệu Hóa Garbage Collection Trong Benchmark<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/huong-dan-benchmark-ruby/#-t%E1%BA%A1m-th%E1%BB%9Di-v%C3%B4-hi%E1%BB%87u-h%C3%B3a-garbage-collection-trong-benchmark" class="hash-link" aria-label="Direct link to 🚫 Tạm Thời Vô Hiệu Hóa Garbage Collection Trong Benchmark" title="Direct link to 🚫 Tạm Thời Vô Hiệu Hóa Garbage Collection Trong Benchmark">​</a></h3>
<p>Garbage collection có thể làm sai lệch kết quả microbenchmark. Bạn có thể tạm thời vô hiệu hóa nó:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">require</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'benchmark'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token constant" style="color:rgb(100, 102, 149)">GC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">disable</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">results </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Benchmark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">measure </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token plain">_000</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">times </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"foo"</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token constant" style="color:rgb(100, 102, 149)">GC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">enable</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">puts results</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_aa2m" id="-kết-hợp-các-số-liệu-phân-bổ-bộ-nhớ-vào-benchmark">📊 Kết Hợp Các Số Liệu Phân Bổ Bộ Nhớ Vào Benchmark<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/huong-dan-benchmark-ruby/#-k%E1%BA%BFt-h%E1%BB%A3p-c%C3%A1c-s%E1%BB%91-li%E1%BB%87u-ph%C3%A2n-b%E1%BB%95-b%E1%BB%99-nh%E1%BB%9B-v%C3%A0o-benchmark" class="hash-link" aria-label="Direct link to 📊 Kết Hợp Các Số Liệu Phân Bổ Bộ Nhớ Vào Benchmark" title="Direct link to 📊 Kết Hợp Các Số Liệu Phân Bổ Bộ Nhớ Vào Benchmark">​</a></h3>
<p>Việc sử dụng bộ nhớ thường quan trọng như thời gian thực thi:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">require</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'benchmark'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">require</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'memory_profiler'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">report </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> MemoryProfiler</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">report </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token plain">_000</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">times </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">Array</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">new</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> rand </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">report</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">pretty_print</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token symbol">to_file</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'allocations.txt'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_aa2m" id="-triển-khai-giai-đoạn-khởi-động-để-ổn-định-jit-và-hiệu-ứng-bộ-nhớ-đệm">🔥 Triển Khai Giai Đoạn Khởi Động Để Ổn Định JIT và Hiệu Ứng Bộ Nhớ Đệm<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/huong-dan-benchmark-ruby/#-tri%E1%BB%83n-khai-giai-%C4%91o%E1%BA%A1n-kh%E1%BB%9Fi-%C4%91%E1%BB%99ng-%C4%91%E1%BB%83-%E1%BB%95n-%C4%91%E1%BB%8Bnh-jit-v%C3%A0-hi%E1%BB%87u-%E1%BB%A9ng-b%E1%BB%99-nh%E1%BB%9B-%C4%91%E1%BB%87m" class="hash-link" aria-label="Direct link to 🔥 Triển Khai Giai Đoạn Khởi Động Để Ổn Định JIT và Hiệu Ứng Bộ Nhớ Đệm" title="Direct link to 🔥 Triển Khai Giai Đoạn Khởi Động Để Ổn Định JIT và Hiệu Ứng Bộ Nhớ Đệm">​</a></h3>
<p>Giai đoạn khởi động giúp ổn định các phép đo bằng cách cho phép VM của Ruby tối ưu hóa đường dẫn mã:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">require</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'benchmark/ips'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Benchmark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">ips</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token symbol">warmup</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">time</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">x</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  x</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">report</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'math sqrt'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> Math</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">sqrt</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">123.456</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  x</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">report</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'pow operator'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">123.456</span><span class="token operator" style="color:rgb(212, 212, 212)">**</span><span class="token number" style="color:rgb(181, 206, 168)">0.5</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="cấp-độ-chuyên-gia-benchmark-cấp-độ-sản-xuất">Cấp Độ Chuyên Gia: Benchmark Cấp Độ Sản Xuất<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/huong-dan-benchmark-ruby/#c%E1%BA%A5p-%C4%91%E1%BB%99-chuy%C3%AAn-gia-benchmark-c%E1%BA%A5p-%C4%91%E1%BB%99-s%E1%BA%A3n-xu%E1%BA%A5t" class="hash-link" aria-label="Direct link to Cấp Độ Chuyên Gia: Benchmark Cấp Độ Sản Xuất" title="Direct link to Cấp Độ Chuyên Gia: Benchmark Cấp Độ Sản Xuất">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_aa2m" id="-tự-động-hóa-bộ-benchmark-với-báo-cáo-html-tương-tác">🛠 Tự Động Hóa Bộ Benchmark Với Báo Cáo HTML Tương Tác<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/huong-dan-benchmark-ruby/#-t%E1%BB%B1-%C4%91%E1%BB%99ng-h%C3%B3a-b%E1%BB%99-benchmark-v%E1%BB%9Bi-b%C3%A1o-c%C3%A1o-html-t%C6%B0%C6%A1ng-t%C3%A1c" class="hash-link" aria-label="Direct link to 🛠 Tự Động Hóa Bộ Benchmark Với Báo Cáo HTML Tương Tác" title="Direct link to 🛠 Tự Động Hóa Bộ Benchmark Với Báo Cáo HTML Tương Tác">​</a></h3>
<p>Để giám sát hiệu suất liên tục, tích hợp benchmark vào pipeline CI của bạn:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">require</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'benchmark'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">require</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'erb'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">require</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'json'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Bước 1: chạy benchmark</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">results </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Benchmark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">bmbm </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">x</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  x</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">report</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'alpha'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> alpha_task </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  x</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">report</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'beta'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> beta_task  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Bước 2: chuẩn bị dữ liệu cho biểu đồ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">chart_data </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> results</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">map </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">r</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token symbol">name</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> r</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">label</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">time</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> r</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">real </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Bước 3: render HTML</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">template </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">ERB</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">new</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token builtin" style="color:rgb(86, 156, 214)">File</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">read</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'report_template.html.erb'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token builtin" style="color:rgb(86, 156, 214)">File</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">write</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'bench_report.html'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> template</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">result_with_hash</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token symbol">data</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> chart_data</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">to_json</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><br></span></code></pre></div></div>
<p>Sau đó, trong pipeline GitHub Actions của bạn, tải lên <code>bench_report.html</code> như một artifact hoặc triển khai lên GitHub Pages để có khả năng hiển thị liên tục.</p>
<h3 class="anchor anchorWithStickyNavbar_aa2m" id="-tinh-chỉnh-benchmarkips-cho-độ-tin-cậy-thống-kê">🚀 Tinh Chỉnh Benchmark.ips Cho Độ Tin Cậy Thống Kê<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/huong-dan-benchmark-ruby/#-tinh-ch%E1%BB%89nh-benchmarkips-cho-%C4%91%E1%BB%99-tin-c%E1%BA%ADy-th%E1%BB%91ng-k%C3%AA" class="hash-link" aria-label="Direct link to 🚀 Tinh Chỉnh Benchmark.ips Cho Độ Tin Cậy Thống Kê" title="Direct link to 🚀 Tinh Chỉnh Benchmark.ips Cho Độ Tin Cậy Thống Kê">​</a></h3>
<p>Đối với các hệ thống quan trọng, độ tin cậy thống kê là rất quan trọng:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">require</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'benchmark/ips'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Benchmark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">ips </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">x</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  x</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">config</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token symbol">time</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">warmup</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">confidence</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">95</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">guarantee</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">99</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  x</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">report</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"fast_path"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># triển khai đã tối ưu hóa</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    FastPath</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">process</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  x</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">report</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"fallback"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># triển khai dự phòng chậm hơn</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    Fallback</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">process</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  x</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">compare</span><span class="token operator" style="color:rgb(212, 212, 212)">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_aa2m" id="-microbenchmark-c-extensions-so-với-ruby-thuần-túy">🔩 Microbenchmark C Extensions So Với Ruby Thuần Túy<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/huong-dan-benchmark-ruby/#-microbenchmark-c-extensions-so-v%E1%BB%9Bi-ruby-thu%E1%BA%A7n-t%C3%BAy" class="hash-link" aria-label="Direct link to 🔩 Microbenchmark C Extensions So Với Ruby Thuần Túy" title="Direct link to 🔩 Microbenchmark C Extensions So Với Ruby Thuần Túy">​</a></h3>
<p>Khi xem xét C extensions cho mã quan trọng về hiệu suất:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">require</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'benchmark/ips'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">require_relative </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'fast_parser'</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># C extension</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">ruby_parser</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  data</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">each_char</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">map</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token symbol">:ord</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">reduce</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token operator" style="color:rgb(212, 212, 212)">^</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Benchmark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">ips </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">x</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  x</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">config</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token symbol">time</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">warmup</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  x</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">report</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"C parser"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> FastParser</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">parse</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">large_string</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  x</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">report</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Ruby parser"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">   </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> ruby_parser</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">large_string</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  x</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">compare</span><span class="token operator" style="color:rgb(212, 212, 212)">!</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token symbol">threshold</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1.05</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># chỉ hiển thị sự khác biệt &gt;5%</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_aa2m" id="️-xây-dựng-bộ-benchmark-tùy-chỉnh-với-khởi-động-và-dọn-dẹp">⚙️ Xây Dựng Bộ Benchmark Tùy Chỉnh Với Khởi Động và Dọn Dẹp<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/huong-dan-benchmark-ruby/#%EF%B8%8F-x%C3%A2y-d%E1%BB%B1ng-b%E1%BB%99-benchmark-t%C3%B9y-ch%E1%BB%89nh-v%E1%BB%9Bi-kh%E1%BB%9Fi-%C4%91%E1%BB%99ng-v%C3%A0-d%E1%BB%8Dn-d%E1%BA%B9p" class="hash-link" aria-label="Direct link to ⚙️ Xây Dựng Bộ Benchmark Tùy Chỉnh Với Khởi Động và Dọn Dẹp" title="Direct link to ⚙️ Xây Dựng Bộ Benchmark Tùy Chỉnh Với Khởi Động và Dọn Dẹp">​</a></h3>
<p>Đối với benchmark cấp doanh nghiệp, một bộ tùy chỉnh cung cấp khả năng kiểm soát tối đa:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">BenchmarkHarness</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">initialize</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token symbol">iterations</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">warmup_cycles</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">@iterations</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> iterations</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">@warmup_cycles</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> warmup_cycles</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">@results</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">run</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">@warmup_cycles</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">times </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">GC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">start </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">@warmup_cycles</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">times </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">yield</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># khởi động</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">@iterations</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">times </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">i</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token constant" style="color:rgb(100, 102, 149)">GC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">start</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token symbol">full_mark</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">immediate_sweep</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      t0 </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Process</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">clock_gettime</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">Process</span><span class="token double-colon punctuation" style="color:rgb(212, 212, 212)">::</span><span class="token constant" style="color:rgb(100, 102, 149)">CLOCK_MONOTONIC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword" style="color:rgb(86, 156, 214)">yield</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      t1 </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Process</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">clock_gettime</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">Process</span><span class="token double-colon punctuation" style="color:rgb(212, 212, 212)">::</span><span class="token constant" style="color:rgb(100, 102, 149)">CLOCK_MONOTONIC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token variable" style="color:rgb(156, 220, 254)">@results</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;&lt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">t1 </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> t0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    summarize</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">summarize</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    avg </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">@results</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">sum </span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">@results</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">size</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    sd </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Math</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">sqrt</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">@results</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">map </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">x</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">x </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> avg</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token operator" style="color:rgb(212, 212, 212)">**</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">sum </span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">@results</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">size</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token symbol">average</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> avg</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">std_dev</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> sd</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">samples</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">@results</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">size </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Cách sử dụng</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">harness </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">BenchmarkHarness</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">new</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token symbol">iterations</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">50</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">warmup_cycles</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">stats </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> harness</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">run </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> MyService</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">call</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">payload</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">puts stats</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_aa2m" id="-kết-hợp-phân-tích-hiệu-suất-và-bộ-nhớ-sử-dụng-memory_profiler">📊 Kết Hợp Phân Tích Hiệu Suất và Bộ Nhớ Sử Dụng memory_profiler<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/huong-dan-benchmark-ruby/#-k%E1%BA%BFt-h%E1%BB%A3p-ph%C3%A2n-t%C3%ADch-hi%E1%BB%87u-su%E1%BA%A5t-v%C3%A0-b%E1%BB%99-nh%E1%BB%9B-s%E1%BB%AD-d%E1%BB%A5ng-memory_profiler" class="hash-link" aria-label="Direct link to 📊 Kết Hợp Phân Tích Hiệu Suất và Bộ Nhớ Sử Dụng memory_profiler" title="Direct link to 📊 Kết Hợp Phân Tích Hiệu Suất và Bộ Nhớ Sử Dụng memory_profiler">​</a></h3>
<p>Để có cái nhìn toàn diện về hiệu suất, kết hợp phân tích thời gian và bộ nhớ:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">require</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'benchmark'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">require</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'memory_profiler'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">report </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> MemoryProfiler</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">report </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  time </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Benchmark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">realtime </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token plain">_000</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">times </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> process_item</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">item</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  puts </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Thời gian thực thi: </span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">#{</span><span class="token string-literal interpolation content">time</span><span class="token string-literal interpolation content punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string-literal interpolation content">round</span><span class="token string-literal interpolation content punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal interpolation content number" style="color:rgb(181, 206, 168)">4</span><span class="token string-literal interpolation content punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">s"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">report</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">pretty_print</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token symbol">to_file</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'memory_report.txt'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="kết-luận">Kết Luận<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/huong-dan-benchmark-ruby/#k%E1%BA%BFt-lu%E1%BA%ADn" class="hash-link" aria-label="Direct link to Kết Luận" title="Direct link to Kết Luận">​</a></h2>
<p>Benchmark trong Ruby là một hành trình từ các phép đo thời gian đơn giản đến phân tích thống kê phức tạp. Khi ứng dụng của bạn ngày càng phức tạp, kỹ thuật benchmark của bạn cũng nên phát triển theo. Bắt đầu với các cơ bản như <code>Benchmark.measure</code> và <code>Benchmark.bm</code>, sau đó tiến tới các công cụ nâng cao hơn như <code>benchmark-ips</code> và các bộ tùy chỉnh khi cần thiết.</p>
<p>Hãy nhớ rằng benchmark không chỉ là tìm mã nhanh nhất—mà là đưa ra quyết định sáng suốt dựa trên dữ liệu thực nghiệm. Đôi khi một triển khai hơi chậm hơn có thể được ưa chuộng nếu nó sử dụng ít bộ nhớ hơn hoặc dễ bảo trì hơn. Luôn xem xét bối cảnh đầy đủ của ứng dụng khi tối ưu hóa hiệu suất.</p>
<p>Bằng cách nắm vững các kỹ thuật benchmark này, bạn sẽ được trang bị tốt để viết mã Ruby hiệu quả, có hiệu suất cao và có thể mở rộng theo nhu cầu của bạn.</p>]]></content:encoded>
            <category>Ruby</category>
            <category>Performance</category>
            <category>Benchmarking</category>
        </item>
        <item>
            <title><![CDATA[Nghệ Thuật Tối Thượng về Mảng trong Ruby: Bí Kíp Chỉ Dành Cho Chuyên Gia]]></title>
            <link>https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-chuyen-gia/</link>
            <guid>https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-chuyen-gia/</guid>
            <pubDate>Wed, 26 Jul 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[Ruby Arrays Expert]]></description>
            <content:encoded><![CDATA[<p><img decoding="async" loading="lazy" src="https://images.unsplash.com/photo-1555099962-4199c345e5dd?ixlib=rb-1.2.1&amp;auto=format&amp;fit=crop&amp;w=1350&amp;q=80" alt="Ruby Arrays Expert" class="img_VBoq"></p>
<p>Bạn đã thành thạo tất cả các kỹ thuật cơ bản, trung cấp và nâng cao về mảng trong Ruby? Đã đến lúc khám phá những bí kíp tối thượng, những kỹ thuật chỉ dành cho các chuyên gia Ruby thực thụ. Bài viết này sẽ đưa bạn đến những ranh giới xa nhất của việc làm việc với mảng trong Ruby, nơi hiệu suất, tính linh hoạt và sự thanh lịch của code được đẩy đến giới hạn.</p>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-xử-lý-song-song-với-threads">🧵 Xử Lý Song Song với Threads<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-chuyen-gia/#-x%E1%BB%AD-l%C3%BD-song-song-v%E1%BB%9Bi-threads" class="hash-link" aria-label="Direct link to 🧵 Xử Lý Song Song với Threads" title="Direct link to 🧵 Xử Lý Song Song với Threads">​</a></h2>
<p>Tận dụng sức mạnh của đa luồng để xử lý mảng lớn một cách hiệu quả:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">require</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'thread'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">require</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'etc'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">Array</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">parallel_map</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token symbol">pool_size</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Etc</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">nprocessors</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> empty</span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    queue   </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">SizedQueue</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">new</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">pool_size</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    results </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">Array</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">new</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">size</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    mutex   </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">Mutex</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">new</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># Tạo nhóm worker threads</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    workers </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> pool_size</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">times</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">map </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token class-name" style="color:rgb(78, 201, 176)">Thread</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">new</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">while</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">item </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> queue</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">pop </span><span class="token keyword" style="color:rgb(86, 156, 214)">rescue</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">nil</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> idx </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> item</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          result </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">yield</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          mutex</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">synchronize </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> results</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">idx</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> result </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># Đưa công việc vào hàng đợi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    each_with_index </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">elem</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> i</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> queue </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;&lt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">elem</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># Đóng hàng đợi và chờ các worker hoàn thành</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    pool_size</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">times </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> queue</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">close </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    workers</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">each</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token symbol">:join</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    results</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Ví dụ sử dụng</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">xu_ly_phuc_tap</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  sleep</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">0.1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># Giả lập xử lý tốn thời gian</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  n </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> n</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Xử lý tuần tự - mất khoảng 1 giây</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">start </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(86, 156, 214)">Time</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">now</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">ket_qua_tuan_tu </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">6</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">7</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">8</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">9</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">map </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">n</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> xu_ly_phuc_tap</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">puts </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Xử lý tuần tự: </span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">#{</span><span class="token string-literal interpolation content builtin" style="color:rgb(86, 156, 214)">Time</span><span class="token string-literal interpolation content punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string-literal interpolation content">now </span><span class="token string-literal interpolation content operator" style="color:rgb(212, 212, 212)">-</span><span class="token string-literal interpolation content"> start</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-literal string" style="color:rgb(206, 145, 120)"> giây"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Xử lý song song - nhanh hơn nhiều</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">start </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(86, 156, 214)">Time</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">now</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">ket_qua_song_song </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">6</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">7</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">8</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">9</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">parallel_map </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">n</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> xu_ly_phuc_tap</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">puts </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Xử lý song song: </span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">#{</span><span class="token string-literal interpolation content builtin" style="color:rgb(86, 156, 214)">Time</span><span class="token string-literal interpolation content punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string-literal interpolation content">now </span><span class="token string-literal interpolation content operator" style="color:rgb(212, 212, 212)">-</span><span class="token string-literal interpolation content"> start</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-literal string" style="color:rgb(206, 145, 120)"> giây"</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-deep-freeze---bảo-vệ-mảng-lồng-nhau-khỏi-thay-đổi">🔒 Deep Freeze - Bảo Vệ Mảng Lồng Nhau Khỏi Thay Đổi<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-chuyen-gia/#-deep-freeze---b%E1%BA%A3o-v%E1%BB%87-m%E1%BA%A3ng-l%E1%BB%93ng-nhau-kh%E1%BB%8Fi-thay-%C4%91%E1%BB%95i" class="hash-link" aria-label="Direct link to 🔒 Deep Freeze - Bảo Vệ Mảng Lồng Nhau Khỏi Thay Đổi" title="Direct link to 🔒 Deep Freeze - Bảo Vệ Mảng Lồng Nhau Khỏi Thay Đổi">​</a></h2>
<p>Tạo mảng bất biến hoàn toàn, bao gồm cả các mảng con và đối tượng bên trong:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">Array</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">deep_freeze</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">each</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">element</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> element</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">deep_freeze </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> element</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">respond_to</span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token symbol">:deep_freeze</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    freeze</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">Hash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">deep_freeze</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    each_value </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">value</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">deep_freeze </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">respond_to</span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token symbol">:deep_freeze</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    freeze</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">Object</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">deep_freeze</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    freeze</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Tạo cấu trúc dữ liệu bất biến hoàn toàn</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">cau_hinh </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token symbol">app_name</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Ruby Master"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token symbol">version</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"1.0.0"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token symbol">settings</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token symbol">timeout</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">30</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token symbol">retries</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token symbol">endpoints</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"api.example.com"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"backup.example.com"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token symbol">features</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"authentication"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"reporting"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"analytics"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">deep_freeze</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Thử thay đổi sẽ gây ra lỗi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># cau_hinh[:version] = "1.0.1"                  # =&gt; FrozenError</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># cau_hinh[:settings][:timeout] = 60            # =&gt; FrozenError</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># cau_hinh[:settings][:endpoints] &lt;&lt; "new.com"  # =&gt; FrozenError</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># cau_hinh[:features][0] = "new-auth"           # =&gt; FrozenError</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-metaprogramming---tạo-phương-thức-mảng-động">🧠 Metaprogramming - Tạo Phương Thức Mảng Động<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-chuyen-gia/#-metaprogramming---t%E1%BA%A1o-ph%C6%B0%C6%A1ng-th%E1%BB%A9c-m%E1%BA%A3ng-%C4%91%E1%BB%99ng" class="hash-link" aria-label="Direct link to 🧠 Metaprogramming - Tạo Phương Thức Mảng Động" title="Direct link to 🧠 Metaprogramming - Tạo Phương Thức Mảng Động">​</a></h2>
<p>Sử dụng metaprogramming để tạo các phương thức xử lý mảng một cách động:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">Array</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># Định nghĩa các phương thức tìm kiếm động</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">%w[first last min max]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">each</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">method_prefix</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">%w[even odd prime]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">each</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">criteria</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      method_name </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">#{</span><span class="token string-literal interpolation content">method_prefix</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">_</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">#{</span><span class="token string-literal interpolation content">criteria</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword" style="color:rgb(86, 156, 214)">define_method</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">method_name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">case</span><span class="token plain"> criteria</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">when</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'even'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token keyword" style="color:rgb(86, 156, 214)">self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">select</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token symbol">:even?</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">public_send</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">method_prefix</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">when</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'odd'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token keyword" style="color:rgb(86, 156, 214)">self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">select</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token symbol">:odd?</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">public_send</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">method_prefix</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">when</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'prime'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token keyword" style="color:rgb(86, 156, 214)">require</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'prime'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token keyword" style="color:rgb(86, 156, 214)">self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">select </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">n</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> Prime</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">prime</span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">public_send</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">method_prefix</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># Tạo phương thức tổng hợp động</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">method_missing</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">method_name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain">args</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain">block</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> method_name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">to_s </span><span class="token operator" style="color:rgb(212, 212, 212)">=~</span><span class="token plain"> </span><span class="token regex-literal regex">/^(sum|product)_of_(.+)$/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      operation</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> property </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> $</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> $</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      values </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> map </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">item</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> item</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">is_a</span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token builtin" style="color:rgb(86, 156, 214)">Hash</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token plain"> item</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">property</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">to_sym</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> item</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">send</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">property</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword" style="color:rgb(86, 156, 214)">case</span><span class="token plain"> operation</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword" style="color:rgb(86, 156, 214)">when</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'sum'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        values</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">sum</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword" style="color:rgb(86, 156, 214)">when</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'product'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        values</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">inject</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword" style="color:rgb(86, 156, 214)">super</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">respond_to_missing</span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">method_name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> include_private </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    method_name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">to_s </span><span class="token operator" style="color:rgb(212, 212, 212)">=~</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token operator" style="color:rgb(212, 212, 212)">^</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">sum</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">product</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">_of_</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token operator" style="color:rgb(212, 212, 212)">+</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">$</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">||</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">super</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Sử dụng các phương thức được tạo động</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">so </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">6</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">7</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">8</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">9</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">11</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">12</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">13</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">so</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">first_even  </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; 2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">so</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">last_odd    </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; 13</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">so</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">max_prime   </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; 13</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Sử dụng với mảng đối tượng</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">san_pham </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token symbol">ten</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Laptop"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">gia</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">15000000</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">so_luong</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token symbol">ten</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Điện thoại"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">gia</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">8000000</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">so_luong</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token symbol">ten</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Tai nghe"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">gia</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1500000</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">so_luong</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">san_pham</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">sum_of_gia       </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; 24500000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">san_pham</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">product_of_so_luong  </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; 100</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-memoized-inject---tối-ưu-hóa-tính-toán-lặp-lại">🧮 Memoized Inject - Tối Ưu Hóa Tính Toán Lặp Lại<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-chuyen-gia/#-memoized-inject---t%E1%BB%91i-%C6%B0u-h%C3%B3a-t%C3%ADnh-to%C3%A1n-l%E1%BA%B7p-l%E1%BA%A1i" class="hash-link" aria-label="Direct link to 🧮 Memoized Inject - Tối Ưu Hóa Tính Toán Lặp Lại" title="Direct link to 🧮 Memoized Inject - Tối Ưu Hóa Tính Toán Lặp Lại">​</a></h2>
<p>Tạo một phiên bản tối ưu của <code>inject</code> với khả năng ghi nhớ kết quả trung gian:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">Array</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">memoized_inject</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">initial </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">nil</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> memo_key </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">nil</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    memo </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    memo_key </span><span class="token operator" style="color:rgb(212, 212, 212)">||=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">acc</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> item</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">acc</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> item</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">hash </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> block_given</span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      inject</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">initial</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">acc</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> item</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        key </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> memo_key</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">call</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">acc</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> item</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        memo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">||=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">yield</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">acc</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> item</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      inject</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">initial</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Tính giai thừa với memoization</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">factorial</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> n </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">memoized_inject</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">acc</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> i</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> acc </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> i </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Tính số Fibonacci với memoization</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">fibonacci_sequence</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> n </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> n </span><span class="token operator" style="color:rgb(212, 212, 212)">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> n </span><span class="token operator" style="color:rgb(212, 212, 212)">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  result </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  memo </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">2.</span><span class="token operator" style="color:rgb(212, 212, 212)">..</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">each</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">i</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    key </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">result</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">i</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> result</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">i</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">hash</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    memo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">||=</span><span class="token plain"> result</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">i</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">+</span><span class="token plain"> result</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">i</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    result </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;&lt;</span><span class="token plain"> memo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  result</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">puts fibonacci_sequence</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">100</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">last  </span><span class="token comment" style="color:rgb(106, 153, 85)"># Tính số Fibonacci thứ 100 rất nhanh</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-enumerator-vô-hạn-lười-biếng">🔄 Enumerator Vô Hạn Lười Biếng<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-chuyen-gia/#-enumerator-v%C3%B4-h%E1%BA%A1n-l%C6%B0%E1%BB%9Di-bi%E1%BA%BFng" class="hash-link" aria-label="Direct link to 🔄 Enumerator Vô Hạn Lười Biếng" title="Direct link to 🔄 Enumerator Vô Hạn Lười Biếng">​</a></h2>
<p>Tạo và làm việc với các dãy vô hạn mà không gây tràn bộ nhớ:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"># Tạo dãy số Fibonacci vô hạn</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">fibonacci </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">Enumerator</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">new</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">yielder</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  a</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> b </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  loop </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    yielder </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;&lt;</span><span class="token plain"> a</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    a</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> b </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(212, 212, 212)">+</span><span class="token plain"> b</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">lazy</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Lấy 10 số Fibonacci đầu tiên</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">fibonacci</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">take</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">force  </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; [0, 1, 1, 2, 3, 5, 8, 13, 21, 34]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Lấy các số Fibonacci lớn hơn 1000 và nhỏ hơn 10000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">fibonacci</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">select </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">n</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> n </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1000</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">take_while </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">n</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> n </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">10000</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">force  </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; [1597, 2584, 4181, 6765]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Tạo dãy số nguyên tố vô hạn</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">require</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'prime'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">primes </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">Enumerator</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">new</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">yielder</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  Prime</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">each</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">prime</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> yielder </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;&lt;</span><span class="token plain"> prime </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">lazy</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Tìm 5 số nguyên tố đầu tiên lớn hơn 1000000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">primes</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">select </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">p</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> p </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1000000</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">take</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">force  </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; [1000003, 1000033, 1000037, 1000039, 1000081]</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-refinements---mở-rộng-mảng-an-toàn">🔌 Refinements - Mở Rộng Mảng An Toàn<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-chuyen-gia/#-refinements---m%E1%BB%9F-r%E1%BB%99ng-m%E1%BA%A3ng-an-to%C3%A0n" class="hash-link" aria-label="Direct link to 🔌 Refinements - Mở Rộng Mảng An Toàn" title="Direct link to 🔌 Refinements - Mở Rộng Mảng An Toàn">​</a></h2>
<p>Sử dụng refinements để mở rộng chức năng của mảng mà không ảnh hưởng đến code khác:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">module</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">ArrayExtensions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  refine </span><span class="token builtin" style="color:rgb(86, 156, 214)">Array</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># Phương thức tìm phần tử phổ biến nhất</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">most_frequent</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      group_by</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token symbol">:itself</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">transform_values</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token symbol">:count</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">max_by </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">_</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> count</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> count </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;.</span><span class="token plain">first</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># Phương thức tính trung bình có trọng số</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">weighted_average</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">weights </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">nil</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">nil</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> empty</span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> weights</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">nil</span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        sum</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">to_f </span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain"> size</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword" style="color:rgb(86, 156, 214)">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">raise</span><span class="token plain"> ArgumentError</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Weights array must have same size as source array"</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> weights</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">size </span><span class="token operator" style="color:rgb(212, 212, 212)">!=</span><span class="token plain"> size</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        sum </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">v</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> v </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> weights</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">index</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">v</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">to_f </span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain"> weights</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">sum</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># Phương thức chia mảng thành các nhóm có kích thước bằng nhau</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">split_into</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">num_groups</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> empty</span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      groups </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">Array</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">new</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">num_groups</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      each_with_index </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">elem</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> i</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> groups</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">i </span><span class="token operator" style="color:rgb(212, 212, 212)">%</span><span class="token plain"> num_groups</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;&lt;</span><span class="token plain"> elem </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      groups</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Sử dụng refinements</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">using ArrayExtensions</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Tìm phần tử phổ biến nhất</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">6</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">7</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">most_frequent  </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; 2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Tính trung bình có trọng số</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">diem </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">8.5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">7.0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">9.5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">trong_so </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">0.3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0.2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0.5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">diem</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">weighted_average</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">trong_so</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; 8.55</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Chia mảng thành các nhóm</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1.</span><span class="token number" style="color:rgb(181, 206, 168)">.10</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">to_a</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">split_into</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; [[1, 4, 7, 10], [2, 5, 8], [3, 6, 9]]</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-binary-packing-với-packunpack">📦 Binary Packing với pack/unpack<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-chuyen-gia/#-binary-packing-v%E1%BB%9Bi-packunpack" class="hash-link" aria-label="Direct link to 📦 Binary Packing với pack/unpack" title="Direct link to 📦 Binary Packing với pack/unpack">​</a></h2>
<p>Sử dụng <code>pack</code> và <code>unpack</code> để chuyển đổi giữa mảng và dữ liệu nhị phân:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"># Chuyển đổi mảng số nguyên thành dữ liệu nhị phân</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">so_nguyen </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">binary_data </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> so_nguyen</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">pack</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'C*'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># 'C' = unsigned char (8-bit)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Chuyển đổi ngược lại từ dữ liệu nhị phân thành mảng</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">so_nguyen_moi </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> binary_data</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">unpack</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'C*'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; [1, 2, 3, 4, 5]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Đóng gói cấu trúc dữ liệu phức tạp</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">serialize_point</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> z</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> z</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">pack</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'d3'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># 'd' = double precision float (64-bit)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">deserialize_point</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">binary</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  binary</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">unpack</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'d3'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; [x, y, z]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Ứng dụng thực tế: Lưu trữ hiệu quả mảng lớn</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">save_large_array</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">array</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> filename</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token builtin" style="color:rgb(86, 156, 214)">File</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">open</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">filename</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'wb'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">file</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># Lưu kích thước mảng</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    file</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">write</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">array</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">size</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">pack</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'N'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># Lưu dữ liệu</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    file</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">write</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">array</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">pack</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'d*'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">load_large_array</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">filename</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token builtin" style="color:rgb(86, 156, 214)">File</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">open</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">filename</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'rb'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">file</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># Đọc kích thước mảng</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    size </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> file</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">read</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">unpack</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'N'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># Đọc dữ liệu</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    file</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">read</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">size </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">8</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">unpack</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'d*'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-biểu-diễn-mảng-dưới-dạng-bitset">🎲 Biểu Diễn Mảng Dưới Dạng BitSet<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-chuyen-gia/#-bi%E1%BB%83u-di%E1%BB%85n-m%E1%BA%A3ng-d%C6%B0%E1%BB%9Bi-d%E1%BA%A1ng-bitset" class="hash-link" aria-label="Direct link to 🎲 Biểu Diễn Mảng Dưới Dạng BitSet" title="Direct link to 🎲 Biểu Diễn Mảng Dưới Dạng BitSet">​</a></h2>
<p>Sử dụng biểu diễn bit để tối ưu hóa bộ nhớ cho các tập hợp số nguyên:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">BitSet</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">initialize</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">size</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">@size</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> size</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">@bits</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">Array</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">new</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">size </span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">32.0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">ceil</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">index</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">nil</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> index </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;=</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">@size</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    word_index </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> index </span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    bit_index </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> index </span><span class="token operator" style="color:rgb(212, 212, 212)">%</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">@bits</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">word_index</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;&lt;</span><span class="token plain"> bit_index</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">!=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">index</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">nil</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> index </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;=</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">@size</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    word_index </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> index </span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    bit_index </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> index </span><span class="token operator" style="color:rgb(212, 212, 212)">%</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> value</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token variable" style="color:rgb(156, 220, 254)">@bits</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">word_index</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;&lt;</span><span class="token plain"> bit_index</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token variable" style="color:rgb(156, 220, 254)">@bits</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">word_index</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">~</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;&lt;</span><span class="token plain"> bit_index</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">to_a</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">0.</span><span class="token operator" style="color:rgb(212, 212, 212)">..</span><span class="token variable" style="color:rgb(156, 220, 254)">@size</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">select </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">i</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">union</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">other</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    result </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">BitSet</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">new</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">@size</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">@bits</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">each_with_index </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">word</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> i</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      result</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">instance_variable_get</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token variable" style="color:rgb(156, 220, 254)">@bits</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> word </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> other</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">instance_variable_get</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token variable" style="color:rgb(156, 220, 254)">@bits</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    result</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">intersection</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">other</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    result </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">BitSet</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">new</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">@size</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">@bits</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">each_with_index </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">word</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> i</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      result</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">instance_variable_get</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token variable" style="color:rgb(156, 220, 254)">@bits</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> word </span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain"> other</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">instance_variable_get</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token variable" style="color:rgb(156, 220, 254)">@bits</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    result</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Sử dụng BitSet để biểu diễn tập hợp hiệu quả</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">max_value </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain">_000_000</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">bitset </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">BitSet</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">new</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">max_value </span><span class="token operator" style="color:rgb(212, 212, 212)">+</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Đánh dấu các số nguyên tố</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">require</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'prime'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Prime</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">each</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">max_value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">prime</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  bitset</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">prime</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Kiểm tra số nguyên tố nhanh chóng</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">bitset</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">997</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">bitset</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">998</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Tạo tập hợp các số nguyên tố trong khoảng</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">primes_under_100 </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">0.</span><span class="token number" style="color:rgb(181, 206, 168)">.100</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">select </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">n</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> bitset</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-tạo-mảng-n-chiều">🧩 Tạo Mảng N Chiều<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-chuyen-gia/#-t%E1%BA%A1o-m%E1%BA%A3ng-n-chi%E1%BB%81u" class="hash-link" aria-label="Direct link to 🧩 Tạo Mảng N Chiều" title="Direct link to 🧩 Tạo Mảng N Chiều">​</a></h2>
<p>Tạo và làm việc với mảng đa chiều một cách linh hoạt:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">NDimensionalArray</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">initialize</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">dimensions</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> default_value </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">nil</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain">block</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">@dimensions</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> dimensions</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">dup</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">@dimensions</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">empty</span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token variable" style="color:rgb(156, 220, 254)">@data</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> default_value</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      current_dim </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">@dimensions</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">shift</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token variable" style="color:rgb(156, 220, 254)">@data</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">Array</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">new</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">current_dim</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">i</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> block_given</span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token class-name" style="color:rgb(78, 201, 176)">NDimensionalArray</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">new</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">@dimensions</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">dup</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> default_value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain">coords</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> block</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">call</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain">coords</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token class-name" style="color:rgb(78, 201, 176)">NDimensionalArray</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">new</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">@dimensions</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">dup</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> default_value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain">indices</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">@data</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> indices</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">empty</span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    current_index </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> indices</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">shift</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> indices</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">empty</span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token variable" style="color:rgb(156, 220, 254)">@data</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">current_index</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token variable" style="color:rgb(156, 220, 254)">@data</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">current_index</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain">indices</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain">indices</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> indices</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">size </span><span class="token operator" style="color:rgb(212, 212, 212)">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token variable" style="color:rgb(156, 220, 254)">@data</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">indices</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> value</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      current_index </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> indices</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">shift</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token variable" style="color:rgb(156, 220, 254)">@data</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">current_index</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain">indices</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> value</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">each</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain">block</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">@data</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">is_a</span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token builtin" style="color:rgb(86, 156, 214)">Array</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token variable" style="color:rgb(156, 220, 254)">@data</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">each_with_index </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">subarray</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> i</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> subarray</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">is_a</span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">NDimensionalArray</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          subarray</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">each_with_coords </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain">coords</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token keyword" style="color:rgb(86, 156, 214)">yield</span><span class="token plain"> value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain">coords</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token keyword" style="color:rgb(86, 156, 214)">yield</span><span class="token plain"> subarray</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> i</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword" style="color:rgb(86, 156, 214)">yield</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">@data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">each_with_coords</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain">block</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">@data</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">is_a</span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token builtin" style="color:rgb(86, 156, 214)">Array</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token variable" style="color:rgb(156, 220, 254)">@data</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">each_with_index </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">subarray</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> i</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> subarray</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">is_a</span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">NDimensionalArray</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          subarray</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">each_with_coords </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain">coords</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token keyword" style="color:rgb(86, 156, 214)">yield</span><span class="token plain"> value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain">coords</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token keyword" style="color:rgb(86, 156, 214)">yield</span><span class="token plain"> subarray</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> i</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword" style="color:rgb(86, 156, 214)">yield</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">@data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">to_a</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">@data</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">is_a</span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token builtin" style="color:rgb(86, 156, 214)">Array</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token variable" style="color:rgb(156, 220, 254)">@data</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">map </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">item</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> item</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">is_a</span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">NDimensionalArray</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token plain"> item</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">to_a </span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> item </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token variable" style="color:rgb(156, 220, 254)">@data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Tạo ma trận 3x3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">matrix </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">NDimensionalArray</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">new</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">matrix</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">matrix</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">matrix</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">9</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Tạo tensor 3x3x3 với giá trị là tổng các chỉ số</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">tensor </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">NDimensionalArray</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">new</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> j</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> k</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> i </span><span class="token operator" style="color:rgb(212, 212, 212)">+</span><span class="token plain"> j </span><span class="token operator" style="color:rgb(212, 212, 212)">+</span><span class="token plain"> k </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Truy cập giá trị</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">tensor</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; 3 (1 + 2 + 0)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-chuỗi-enumerator-tùy-chỉnh">🔗 Chuỗi Enumerator Tùy Chỉnh<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-chuyen-gia/#-chu%E1%BB%97i-enumerator-t%C3%B9y-ch%E1%BB%89nh" class="hash-link" aria-label="Direct link to 🔗 Chuỗi Enumerator Tùy Chỉnh" title="Direct link to 🔗 Chuỗi Enumerator Tùy Chỉnh">​</a></h2>
<p>Tạo và kết hợp các enumerator tùy chỉnh để xử lý dữ liệu phức tạp:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">module</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">EnumeratorChaining</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  refine Enumerator </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">chain</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">other</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token class-name" style="color:rgb(78, 201, 176)">Enumerator</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">new</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">yielder</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">each</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">value</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> yielder </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;&lt;</span><span class="token plain"> value </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        other</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">each</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">value</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> yielder </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;&lt;</span><span class="token plain"> value </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">zip_with</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">other</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token class-name" style="color:rgb(78, 201, 176)">Enumerator</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">new</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">yielder</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        loop </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          yielder </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;&lt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token keyword" style="color:rgb(86, 156, 214)">self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">next</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> other</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">next</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword" style="color:rgb(86, 156, 214)">rescue</span><span class="token plain"> StopIteration</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">nil</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">interleave</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">other</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token class-name" style="color:rgb(78, 201, 176)">Enumerator</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">new</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">yielder</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        loop </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          yielder </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;&lt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">next</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          yielder </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;&lt;</span><span class="token plain"> other</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">next</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword" style="color:rgb(86, 156, 214)">rescue</span><span class="token plain"> StopIteration</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">nil</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">batch</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">size</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token class-name" style="color:rgb(78, 201, 176)">Enumerator</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">new</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">yielder</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        buffer </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">each</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">item</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          buffer </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;&lt;</span><span class="token plain"> item</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> buffer</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">size </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;=</span><span class="token plain"> size</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            yielder </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;&lt;</span><span class="token plain"> buffer</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            buffer </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        yielder </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;&lt;</span><span class="token plain"> buffer </span><span class="token keyword" style="color:rgb(86, 156, 214)">unless</span><span class="token plain"> buffer</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">empty</span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">using EnumeratorChaining</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Kết hợp các dãy số</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">fibonacci </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">Enumerator</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">new</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">yielder</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  a</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> b </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  loop </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    yielder </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;&lt;</span><span class="token plain"> a</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    a</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> b </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(212, 212, 212)">+</span><span class="token plain"> b</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">squares </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">Enumerator</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">new</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">yielder</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  n </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  loop </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    yielder </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;&lt;</span><span class="token plain"> n </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> n</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    n </span><span class="token operator" style="color:rgb(212, 212, 212)">+=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Kết hợp hai dãy số</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">combined </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> fibonacci</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">lazy</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">take</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">chain</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">squares</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">lazy</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">take</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">combined</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">to_a  </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; [0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 0, 1, 4, 9, 16, 25, 36, 49, 64, 81]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Ghép cặp các phần tử</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">pairs </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> fibonacci</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">lazy</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">take</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">zip_with</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">squares</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">lazy</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">pairs</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">take</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">force  </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; [[0, 0], [1, 1], [1, 4], [2, 9], [3, 16]]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Xen kẽ các phần tử</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">interleaved </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> fibonacci</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">lazy</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">take</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">interleave</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">squares</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">lazy</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">take</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">interleaved</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">to_a  </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; [0, 0, 1, 1, 1, 4, 2, 9, 3, 16]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Xử lý theo lô</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">batched </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1.</span><span class="token number" style="color:rgb(181, 206, 168)">.10</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">each</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">batch</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">batched</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">to_a  </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; [[1, 2, 3], [4, 5, 6], [7, 8, 9], [10]]</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-kết-luận">🎯 Kết luận<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-chuyen-gia/#-k%E1%BA%BFt-lu%E1%BA%ADn" class="hash-link" aria-label="Direct link to 🎯 Kết luận" title="Direct link to 🎯 Kết luận">​</a></h2>
<p>Những kỹ thuật chuyên gia này đại diện cho trình độ cao nhất trong việc làm việc với mảng trong Ruby. Chúng không chỉ giúp bạn viết code hiệu quả và tối ưu mà còn mở ra những khả năng mới trong việc xử lý dữ liệu phức tạp.</p>
<p>Hãy nhớ rằng, với sức mạnh lớn đi kèm trách nhiệm lớn. Những kỹ thuật này rất mạnh mẽ nhưng cũng có thể làm cho code của bạn trở nên khó hiểu nếu sử dụng không đúng cách. Luôn cân nhắc giữa sự phức tạp và tính dễ đọc của code.</p>
<p>Bạn đã sẵn sàng trở thành bậc thầy về mảng trong Ruby chưa? Hãy thử nghiệm và áp dụng những kỹ thuật này vào dự án của bạn!</p>
<hr>
<p>Bạn có kỹ thuật xử lý mảng nâng cao nào khác muốn chia sẻ? Hãy để lại bình luận bên dưới nhé!</p>]]></content:encoded>
            <category>Ruby</category>
            <category>Arrays</category>
            <category>Expert</category>
        </item>
        <item>
            <title><![CDATA[Bậc Thầy Xử Lý Mảng Trong Ruby: Những Kỹ Thuật Nâng Cao Đỉnh Cao]]></title>
            <link>https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-nang-cao/</link>
            <guid>https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-nang-cao/</guid>
            <pubDate>Tue, 25 Jul 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[Ruby Arrays Advanced]]></description>
            <content:encoded><![CDATA[<p><img decoding="async" loading="lazy" src="https://images.unsplash.com/photo-1517694712202-14dd9538aa97?ixlib=rb-1.2.1&amp;auto=format&amp;fit=crop&amp;w=1350&amp;q=80" alt="Ruby Arrays Advanced" class="img_VBoq"></p>
<p>Bạn đã thành thạo các kỹ thuật cơ bản và trung cấp về mảng trong Ruby? Đã đến lúc khám phá những kỹ thuật nâng cao, những "vũ khí bí mật" giúp code của bạn trở nên tinh tế, hiệu quả và đẳng cấp hơn. Hãy cùng đi sâu vào thế giới của những bậc thầy Ruby!</p>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="️-pattern-matching-với-mảng---phép-thuật-mới-từ-ruby-30">🧙‍♂️ Pattern Matching với Mảng - Phép Thuật Mới từ Ruby 3.0<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-nang-cao/#%EF%B8%8F-pattern-matching-v%E1%BB%9Bi-m%E1%BA%A3ng---ph%C3%A9p-thu%E1%BA%ADt-m%E1%BB%9Bi-t%E1%BB%AB-ruby-30" class="hash-link" aria-label="Direct link to 🧙‍♂️ Pattern Matching với Mảng - Phép Thuật Mới từ Ruby 3.0" title="Direct link to 🧙‍♂️ Pattern Matching với Mảng - Phép Thuật Mới từ Ruby 3.0">​</a></h2>
<p>Pattern matching là một trong những tính năng mạnh mẽ nhất được giới thiệu từ Ruby 3.0, giúp bạn trích xuất dữ liệu từ các cấu trúc phức tạp một cách dễ dàng:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">phan_tich_du_lieu</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">case</span><span class="token plain"> data</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">in</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">id_nguoi_dung</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">nam</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> thang</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> ngay</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain">nhan</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    puts </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Người dùng </span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">#{</span><span class="token string-literal interpolation content">id_nguoi_dung</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-literal string" style="color:rgb(206, 145, 120)"> vào ngày </span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">#{</span><span class="token string-literal interpolation content">ngay</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">/</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">#{</span><span class="token string-literal interpolation content">thang</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">/</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">#{</span><span class="token string-literal interpolation content">nam</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-literal string" style="color:rgb(206, 145, 120)"> với nhãn: </span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">#{</span><span class="token string-literal interpolation content">nhan</span><span class="token string-literal interpolation content punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string-literal interpolation content">inspect</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">in</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">id_nguoi_dung</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> thoi_gian</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    puts </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Người dùng </span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">#{</span><span class="token string-literal interpolation content">id_nguoi_dung</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-literal string" style="color:rgb(206, 145, 120)"> vào lúc </span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">#{</span><span class="token string-literal interpolation content">thoi_gian</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    puts </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Dữ liệu không hợp lệ"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Sử dụng pattern matching</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">du_lieu </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">42</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">2023</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">7</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">25</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'ruby'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'arrays'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">phan_tich_du_lieu</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">du_lieu</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; "Người dùng 42 vào ngày 25/7/2023 với nhãn: [\"ruby\", \"arrays\"]"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Pattern matching trong tham số hàm</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">xu_ly_toa_do</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> z</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  puts </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Tọa độ 2D: (</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">#{</span><span class="token string-literal interpolation content">x</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">, </span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">#{</span><span class="token string-literal interpolation content">y</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">), Độ cao: </span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">#{</span><span class="token string-literal interpolation content">z</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">xu_ly_toa_do</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">20</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; "Tọa độ 2D: (10, 20), Độ cao: 5"</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-lazy-enumerators---sức-mạnh-của-sự-lười-biếng">🔄 Lazy Enumerators - Sức Mạnh của Sự Lười Biếng<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-nang-cao/#-lazy-enumerators---s%E1%BB%A9c-m%E1%BA%A1nh-c%E1%BB%A7a-s%E1%BB%B1-l%C6%B0%E1%BB%9Di-bi%E1%BA%BFng" class="hash-link" aria-label="Direct link to 🔄 Lazy Enumerators - Sức Mạnh của Sự Lười Biếng" title="Direct link to 🔄 Lazy Enumerators - Sức Mạnh của Sự Lười Biếng">​</a></h2>
<p>Lazy enumerators cho phép bạn xử lý các tập dữ liệu lớn một cách hiệu quả bằng cách chỉ tính toán khi cần thiết:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"># Tạo một dãy vô hạn các số nguyên tố</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">require</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'prime'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">so_nguyen_to_vo_han </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Prime</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">each</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Không hiệu quả và sẽ chạy mãi mãi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># so_nguyen_to_dau = so_nguyen_to_vo_han.take(10)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Sử dụng lazy để xử lý hiệu quả</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">so_nguyen_to_lon </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> so_nguyen_to_vo_han</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">lazy</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">select </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">p</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> p </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1000</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">take</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">force</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; [1009, 1013, 1019, 1021, 1031]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Xử lý tệp lớn theo dòng mà không cần đọc toàn bộ vào bộ nhớ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">doc_va_xu_ly_tep_lon</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">duong_dan</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token builtin" style="color:rgb(86, 156, 214)">File</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">open</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">duong_dan</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'r'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">each_line</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">lazy</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">map</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token symbol">:chomp</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">select </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">line</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> line</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">include</span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'ERROR'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">take</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">force</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-nhóm-dữ-liệu-với-each_with_object">🧩 Nhóm Dữ Liệu với each_with_object<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-nang-cao/#-nh%C3%B3m-d%E1%BB%AF-li%E1%BB%87u-v%E1%BB%9Bi-each_with_object" class="hash-link" aria-label="Direct link to 🧩 Nhóm Dữ Liệu với each_with_object" title="Direct link to 🧩 Nhóm Dữ Liệu với each_with_object">​</a></h2>
<p>Phương thức <code>each_with_object</code> cung cấp cách tiếp cận thanh lịch để xây dựng cấu trúc dữ liệu phức tạp:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">sinh_vien </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token symbol">ten</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Minh"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">lop</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"12A"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">diem</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">8.5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token symbol">ten</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Hương"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">lop</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"12A"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">diem</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">9.0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token symbol">ten</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Tuấn"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">lop</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"12B"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">diem</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">7.5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token symbol">ten</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Linh"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">lop</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"12B"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">diem</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">8.0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token symbol">ten</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Nam"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">lop</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"12C"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">diem</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">9.5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Nhóm sinh viên theo lớp</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">sinh_vien_theo_lop </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> sinh_vien</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">each_with_object</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">sv</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> result</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">result</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">sv</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token symbol">:lop</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">||=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;&lt;</span><span class="token plain"> sv</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; {</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#      "12A" =&gt; [{ten: "Minh", lop: "12A", diem: 8.5}, {ten: "Hương", lop: "12A", diem: 9.0}],</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#      "12B" =&gt; [{ten: "Tuấn", lop: "12B", diem: 7.5}, {ten: "Linh", lop: "12B", diem: 8.0}],</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#      "12C" =&gt; [{ten: "Nam", lop: "12C", diem: 9.5}]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#    }</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Tính điểm trung bình theo lớp</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">diem_trung_binh_theo_lop </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> sinh_vien</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">each_with_object</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">sv</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> result</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  lop </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> sv</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token symbol">:lop</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  result</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">lop</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">||=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token symbol">tong_diem</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">so_sv</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  result</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">lop</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token symbol">:tong_diem</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">+=</span><span class="token plain"> sv</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token symbol">:diem</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  result</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">lop</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token symbol">:so_sv</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">+=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">transform_values </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">v</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> v</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token symbol">:tong_diem</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain"> v</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token symbol">:so_sv</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; {"12A" =&gt; 8.75, "12B" =&gt; 7.75, "12C" =&gt; 9.5}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-tùy-chỉnh-phương-thức-uniq-với-khối-lệnh">🧠 Tùy Chỉnh Phương Thức uniq với Khối Lệnh<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-nang-cao/#-t%C3%B9y-ch%E1%BB%89nh-ph%C6%B0%C6%A1ng-th%E1%BB%A9c-uniq-v%E1%BB%9Bi-kh%E1%BB%91i-l%E1%BB%87nh" class="hash-link" aria-label="Direct link to 🧠 Tùy Chỉnh Phương Thức uniq với Khối Lệnh" title="Direct link to 🧠 Tùy Chỉnh Phương Thức uniq với Khối Lệnh">​</a></h2>
<p>Phương thức <code>uniq</code> có thể được tùy chỉnh để xác định "tính duy nhất" dựa trên tiêu chí phức tạp:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">san_pham </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token symbol">id</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">ten</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"iPhone"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">hang</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Apple"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">gia</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">20000000</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token symbol">id</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">ten</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Galaxy"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">hang</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Samsung"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">gia</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">18000000</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token symbol">id</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">ten</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"iPhone Pro"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">hang</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Apple"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">gia</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">30000000</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token symbol">id</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">ten</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Redmi"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">hang</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Xiaomi"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">gia</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">5000000</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Lấy sản phẩm duy nhất theo hãng</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">san_pham_theo_hang </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> san_pham</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">uniq </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">sp</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> sp</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token symbol">:hang</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; [</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#      {id: 1, ten: "iPhone", hang: "Apple", gia: 20000000},</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#      {id: 2, ten: "Galaxy", hang: "Samsung", gia: 18000000},</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#      {id: 4, ten: "Redmi", hang: "Xiaomi", gia: 5000000}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#    ]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Ứng dụng thực tế: Lọc email trùng lặp không phân biệt hoa thường</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">emails </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"user@example.com"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"USER@EXAMPLE.COM"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"another@gmail.com"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Another@Gmail.com"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">emails_duy_nhat </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> emails</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">uniq </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">email</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> email</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">downcase </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; ["user@example.com", "another@gmail.com"]</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-tổ-hợp-và-hoán-vị-với-mảng">🧮 Tổ Hợp và Hoán Vị với Mảng<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-nang-cao/#-t%E1%BB%95-h%E1%BB%A3p-v%C3%A0-ho%C3%A1n-v%E1%BB%8B-v%E1%BB%9Bi-m%E1%BA%A3ng" class="hash-link" aria-label="Direct link to 🧮 Tổ Hợp và Hoán Vị với Mảng" title="Direct link to 🧮 Tổ Hợp và Hoán Vị với Mảng">​</a></h2>
<p>Ruby cung cấp các phương thức mạnh mẽ để làm việc với tổ hợp và hoán vị:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">nguyen_to </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">7</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Tạo tất cả các tổ hợp có thể có kích thước 2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">to_hop </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> nguyen_to</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">combination</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">to_a</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; [[2, 3], [2, 5], [2, 7], [3, 5], [3, 7], [5, 7]]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Tạo tất cả các hoán vị có thể có</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">hoan_vi </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> nguyen_to</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">permutation</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">to_a</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; [[2, 3, 5], [2, 3, 7], [2, 5, 3], [2, 5, 7], [2, 7, 3], [2, 7, 5], ...]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Ứng dụng thực tế: Tạo tất cả các mật khẩu có thể từ một tập ký tự</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">ky_tu </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'A'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'B'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'C'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'1'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'2'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">mat_khau_co_the </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> ky_tu</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">repeated_permutation</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">map</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token symbol">:join</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; ["AAA", "AA1", "AA2", "A1A", "A11", "A12", "A2A", "A21", "A22", ...]</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-chia-mảng-thành-các-phần-bằng-nhau">🔪 Chia Mảng Thành Các Phần Bằng Nhau<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-nang-cao/#-chia-m%E1%BA%A3ng-th%C3%A0nh-c%C3%A1c-ph%E1%BA%A7n-b%E1%BA%B1ng-nhau" class="hash-link" aria-label="Direct link to 🔪 Chia Mảng Thành Các Phần Bằng Nhau" title="Direct link to 🔪 Chia Mảng Thành Các Phần Bằng Nhau">​</a></h2>
<p>Tạo một phương thức để chia mảng thành các phần có kích thước gần bằng nhau:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">Array</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">balanced_split</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">num_chunks</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> empty</span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    chunk_size </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">size</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">to_f </span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain"> num_chunks</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">ceil</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    each_slice</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">chunk_size</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">to_a</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Chia mảng thành các phần gần bằng nhau</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">du_lieu </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1.</span><span class="token number" style="color:rgb(181, 206, 168)">.10</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">to_a</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">du_lieu</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">balanced_split</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; [[1, 2, 3, 4], [5, 6, 7], [8, 9, 10]]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Ứng dụng thực tế: Phân chia công việc cho nhiều luồng xử lý</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">cong_viec </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1.</span><span class="token number" style="color:rgb(181, 206, 168)">.20</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">to_a</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">so_luong_worker </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">cong_viec_theo_worker </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> cong_viec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">balanced_split</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">so_luong_worker</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; [[1, 2, 3, 4, 5], [6, 7, 8, 9, 10], [11, 12, 13, 14, 15], [16, 17, 18, 19, 20]]</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-phân-đoạn-mảng-với-slice_when">🔍 Phân Đoạn Mảng với slice_when<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-nang-cao/#-ph%C3%A2n-%C4%91o%E1%BA%A1n-m%E1%BA%A3ng-v%E1%BB%9Bi-slice_when" class="hash-link" aria-label="Direct link to 🔍 Phân Đoạn Mảng với slice_when" title="Direct link to 🔍 Phân Đoạn Mảng với slice_when">​</a></h2>
<p>Phương thức <code>slice_when</code> cho phép bạn chia mảng thành các phân đoạn dựa trên điều kiện giữa các phần tử liên tiếp:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"># Phân đoạn mảng số thành các dãy liên tiếp</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">so </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">6</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">8</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">9</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">12</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">day_lien_tiep </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> so</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">slice_when </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> j</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> j </span><span class="token operator" style="color:rgb(212, 212, 212)">!=</span><span class="token plain"> i </span><span class="token operator" style="color:rgb(212, 212, 212)">+</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">to_a</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; [[1, 2, 3], [5, 6], [8, 9, 10], [12]]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Ứng dụng thực tế: Nhóm các giao dịch theo ngày</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">giao_dich </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token symbol">ngay</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"2023-07-20"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">so_tien</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">100000</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token symbol">ngay</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"2023-07-20"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">so_tien</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">200000</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token symbol">ngay</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"2023-07-21"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">so_tien</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">150000</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token symbol">ngay</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"2023-07-21"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">so_tien</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">300000</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token symbol">ngay</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"2023-07-23"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">so_tien</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">500000</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">giao_dich_theo_ngay </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> giao_dich</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">slice_when </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> b</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token symbol">:ngay</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">!=</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token symbol">:ngay</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">to_a</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; [</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#      [{ngay: "2023-07-20", so_tien: 100000}, {ngay: "2023-07-20", so_tien: 200000}],</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#      [{ngay: "2023-07-21", so_tien: 150000}, {ngay: "2023-07-21", so_tien: 300000}],</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#      [{ngay: "2023-07-23", so_tien: 500000}]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#    ]</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-xử-lý-mảng-không-đều-với-transpose">🔄 Xử Lý Mảng Không Đều với Transpose<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-nang-cao/#-x%E1%BB%AD-l%C3%BD-m%E1%BA%A3ng-kh%C3%B4ng-%C4%91%E1%BB%81u-v%E1%BB%9Bi-transpose" class="hash-link" aria-label="Direct link to 🔄 Xử Lý Mảng Không Đều với Transpose" title="Direct link to 🔄 Xử Lý Mảng Không Đều với Transpose">​</a></h2>
<p>Khi làm việc với mảng không đều (jagged arrays), phương thức <code>transpose</code> tiêu chuẩn sẽ gặp lỗi. Hãy tạo một phiên bản nâng cao:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">Array</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">safe_transpose</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> empty</span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    max_size </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> map</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token symbol">:size</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">max</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    map </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">row</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> row</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">fill</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">nil</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> row</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">size</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> max_size </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> row</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">size</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">transpose</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Xử lý mảng không đều</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">mang_khong_deu </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">6</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">7</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">8</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">9</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">mang_chuyen_vi </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> mang_khong_deu</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">safe_transpose</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; [</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#      [1, 4, 6],</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#      [2, 5, 7],</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#      [3, nil, 8],</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#      [nil, nil, 9]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#    ]</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-xử-lý-dữ-liệu-với-pipeline-sử-dụng-tap-và-then">🚀 Xử Lý Dữ Liệu với Pipeline Sử Dụng tap và then<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-nang-cao/#-x%E1%BB%AD-l%C3%BD-d%E1%BB%AF-li%E1%BB%87u-v%E1%BB%9Bi-pipeline-s%E1%BB%AD-d%E1%BB%A5ng-tap-v%C3%A0-then" class="hash-link" aria-label="Direct link to 🚀 Xử Lý Dữ Liệu với Pipeline Sử Dụng tap và then" title="Direct link to 🚀 Xử Lý Dữ Liệu với Pipeline Sử Dụng tap và then">​</a></h2>
<p>Tạo các pipeline xử lý dữ liệu thanh lịch với <code>tap</code> và <code>then</code>:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"># Xử lý dữ liệu theo pipeline</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">xu_ly_du_lieu</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">du_lieu</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  du_lieu</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">then</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">data</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">map </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">item</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> item</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">downcase </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">tap </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">data</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> puts </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Sau khi chuyển thành chữ thường: </span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">#{</span><span class="token string-literal interpolation content">data</span><span class="token string-literal interpolation content punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string-literal interpolation content">inspect</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">then</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">data</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">select </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">item</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> item</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">length </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">tap </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">data</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> puts </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Sau khi lọc theo độ dài: </span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">#{</span><span class="token string-literal interpolation content">data</span><span class="token string-literal interpolation content punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string-literal interpolation content">inspect</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">then</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">data</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">map </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">item</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> item</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">capitalize </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">tap </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">data</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> puts </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Kết quả cuối cùng: </span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">#{</span><span class="token string-literal interpolation content">data</span><span class="token string-literal interpolation content punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string-literal interpolation content">inspect</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">xu_ly_du_lieu</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"RUBY"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"JS"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"PYTHON"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"GO"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; Sau khi chuyển thành chữ thường: ["ruby", "js", "python", "go"]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; Sau khi lọc theo độ dài: ["ruby", "python"]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; Kết quả cuối cùng: ["Ruby", "Python"]</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-làm-phẳng-mảng-có-chọn-lọc">🧹 Làm Phẳng Mảng Có Chọn Lọc<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-nang-cao/#-l%C3%A0m-ph%E1%BA%B3ng-m%E1%BA%A3ng-c%C3%B3-ch%E1%BB%8Dn-l%E1%BB%8Dc" class="hash-link" aria-label="Direct link to 🧹 Làm Phẳng Mảng Có Chọn Lọc" title="Direct link to 🧹 Làm Phẳng Mảng Có Chọn Lọc">​</a></h2>
<p>Tạo một phương thức để làm phẳng mảng lồng nhau một cách có chọn lọc:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">Array</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token method-definition function" style="color:rgb(220, 220, 170)">selective_flatten</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">condition</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    each_with_object</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">element</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> result</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> element</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">is_a</span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token builtin" style="color:rgb(86, 156, 214)">Array</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;&amp;</span><span class="token plain"> condition</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">call</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">element</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        result</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">concat</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">element</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword" style="color:rgb(86, 156, 214)">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        result </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;&lt;</span><span class="token plain"> element</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Làm phẳng có chọn lọc</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">du_lieu </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">6</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">7</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">8</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">9</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">ket_qua </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> du_lieu</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">selective_flatten </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">arr</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> arr</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">size </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; [1, 2, 3, 4, 5, 6, 7, 8, [9]]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Ứng dụng thực tế: Làm phẳng cấu trúc dữ liệu phức tạp</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">cau_truc </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token symbol">id</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">ten</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Minh"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token symbol">id</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">ten</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Hương"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token symbol">id</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">ten</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Tuấn"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token symbol">id</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">ten</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Linh"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token symbol">id</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">ten</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Nam"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">nguoi_dung </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> cau_truc</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">selective_flatten </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">arr</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> arr</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">all</span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">e</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> e</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">is_a</span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token builtin" style="color:rgb(86, 156, 214)">Hash</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;&amp;</span><span class="token plain"> e</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">key</span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token symbol">:id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; [{id: 1, ten: "Minh"}, {id: 2, ten: "Hương"}, {id: 3, ten: "Tuấn"}, {id: 4, ten: "Linh"}, [{id: 5, ten: "Nam"}]]</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-kết-luận">🎯 Kết luận<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-nang-cao/#-k%E1%BA%BFt-lu%E1%BA%ADn" class="hash-link" aria-label="Direct link to 🎯 Kết luận" title="Direct link to 🎯 Kết luận">​</a></h2>
<p>Những kỹ thuật nâng cao này sẽ giúp bạn xử lý mảng trong Ruby một cách mạnh mẽ và tinh tế hơn. Việc nắm vững và áp dụng chúng không chỉ giúp code của bạn ngắn gọn, dễ đọc mà còn tối ưu hiệu suất xử lý dữ liệu.</p>
<p>Hãy thử nghiệm và kết hợp các kỹ thuật này để tạo ra những giải pháp sáng tạo cho các vấn đề phức tạp trong dự án của bạn!</p>
<hr>
<p>Bạn đã từng áp dụng kỹ thuật nâng cao nào khác khi làm việc với mảng trong Ruby? Hãy chia sẻ kinh nghiệm của bạn trong phần bình luận nhé!</p>]]></content:encoded>
            <category>Ruby</category>
            <category>Arrays</category>
            <category>Advanced</category>
        </item>
        <item>
            <title><![CDATA[Nghệ Thuật Xử Lý Mảng Trong Ruby: Kỹ Thuật Trung Cấp Đáng Kinh Ngạc]]></title>
            <link>https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-trung-cap/</link>
            <guid>https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-trung-cap/</guid>
            <pubDate>Mon, 24 Jul 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[Ruby Arrays Intermediate]]></description>
            <content:encoded><![CDATA[<p><img decoding="async" loading="lazy" src="https://images.unsplash.com/photo-1555066931-4365d14bab8c?ixlib=rb-1.2.1&amp;auto=format&amp;fit=crop&amp;w=1350&amp;q=80" alt="Ruby Arrays Intermediate" class="img_VBoq"></p>
<p>Bạn đã nắm vững các kiến thức cơ bản về mảng trong Ruby? Đã đến lúc nâng cao kỹ năng của bạn với những kỹ thuật trung cấp đầy sức mạnh. Bài viết này sẽ giới thiệu những phương pháp xử lý mảng thông minh hơn, giúp code của bạn trở nên sạch sẽ và hiệu quả hơn.</p>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-cắt-mảng-với-slice-range-và-chỉ-số-âm">🔪 Cắt mảng với slice, range và chỉ số âm<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-trung-cap/#-c%E1%BA%AFt-m%E1%BA%A3ng-v%E1%BB%9Bi-slice-range-v%C3%A0-ch%E1%BB%89-s%E1%BB%91-%C3%A2m" class="hash-link" aria-label="Direct link to 🔪 Cắt mảng với slice, range và chỉ số âm" title="Direct link to 🔪 Cắt mảng với slice, range và chỉ số âm">​</a></h2>
<p>Ruby cung cấp nhiều cách linh hoạt để cắt và trích xuất phần tử từ mảng:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">du_lieu </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'a'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'b'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'c'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'d'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'e'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'f'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'g'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Sử dụng slice với chỉ số bắt đầu và số lượng phần tử</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">du_lieu</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">slice</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">      </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; ['c', 'd', 'e']</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Sử dụng range</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">du_lieu</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1.</span><span class="token number" style="color:rgb(181, 206, 168)">.4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">            </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; ['b', 'c', 'd', 'e']</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">du_lieu</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token number" style="color:rgb(181, 206, 168)">.4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">           </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; ['b', 'c', 'd'] (không bao gồm phần tử cuối)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Sử dụng chỉ số âm</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">du_lieu</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">3.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">          </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; ['e', 'f', 'g']</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">du_lieu</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">5.</span><span class="token operator" style="color:rgb(212, 212, 212)">..</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">         </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; ['c', 'd', 'e']</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-tìm-kiếm-nhị-phân-với-bsearch">🧠 Tìm kiếm nhị phân với bsearch<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-trung-cap/#-t%C3%ACm-ki%E1%BA%BFm-nh%E1%BB%8B-ph%C3%A2n-v%E1%BB%9Bi-bsearch" class="hash-link" aria-label="Direct link to 🧠 Tìm kiếm nhị phân với bsearch" title="Direct link to 🧠 Tìm kiếm nhị phân với bsearch">​</a></h2>
<p>Khi làm việc với mảng đã sắp xếp, <code>bsearch</code> giúp tìm kiếm phần tử nhanh chóng với độ phức tạp O(log n):</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">so_nguyen </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">8</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">11</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">15</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">19</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">24</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">28</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">31</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">36</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">42</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Tìm giá trị chính xác</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">so_nguyen</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">bsearch </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">x</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> x </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">15</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; 15</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Tìm vị trí đầu tiên thỏa mãn điều kiện</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">vi_tri </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> so_nguyen</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">bsearch_index </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">x</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> x </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">30</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; 8 (vị trí của số 31)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Tìm kiếm phức tạp hơn</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">diem_sinh_vien </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token symbol">ten</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"An"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">diem</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">7.5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token symbol">ten</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Bình"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">diem</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">8.0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token symbol">ten</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Cường"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">diem</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">8.5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token symbol">ten</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Dung"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">diem</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">9.0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">sort_by </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">sv</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> sv</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token symbol">:diem</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Tìm sinh viên đầu tiên có điểm &gt;= 8.5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">diem_sinh_vien</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">bsearch </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">sv</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> sv</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token symbol">:diem</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">8.5</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; {ten: "Cường", diem: 8.5}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-chuyển-vị-ma-trận---biến-đổi-dữ-liệu-đa-chiều">🔄 Chuyển vị ma trận - Biến đổi dữ liệu đa chiều<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-trung-cap/#-chuy%E1%BB%83n-v%E1%BB%8B-ma-tr%E1%BA%ADn---bi%E1%BA%BFn-%C4%91%E1%BB%95i-d%E1%BB%AF-li%E1%BB%87u-%C4%91a-chi%E1%BB%81u" class="hash-link" aria-label="Direct link to 🔄 Chuyển vị ma trận - Biến đổi dữ liệu đa chiều" title="Direct link to 🔄 Chuyển vị ma trận - Biến đổi dữ liệu đa chiều">​</a></h2>
<p>Phương thức <code>transpose</code> cho phép bạn chuyển đổi hàng thành cột và ngược lại trong mảng hai chiều:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">ma_tran </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">6</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">7</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">8</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">9</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">ma_tran_chuyen_vi </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> ma_tran</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">transpose</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; [</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#      [1, 4, 7],</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#      [2, 5, 8],</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#      [3, 6, 9]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#    ]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Ứng dụng thực tế: Chuyển đổi dữ liệu CSV</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">du_lieu_csv </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Tên"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Tuổi"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Thành phố"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Minh"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"28"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Hà Nội"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Hương"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"25"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Đà Nẵng"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Tuấn"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"30"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"TP.HCM"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">du_lieu_theo_cot </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> du_lieu_csv</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">transpose</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; [</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#      ["Tên", "Minh", "Hương", "Tuấn"],</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#      ["Tuổi", "28", "25", "30"],</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#      ["Thành phố", "Hà Nội", "Đà Nẵng", "TP.HCM"]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#    ]</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-phân-vùng-mảng-với-partition">🧩 Phân vùng mảng với partition<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-trung-cap/#-ph%C3%A2n-v%C3%B9ng-m%E1%BA%A3ng-v%E1%BB%9Bi-partition" class="hash-link" aria-label="Direct link to 🧩 Phân vùng mảng với partition" title="Direct link to 🧩 Phân vùng mảng với partition">​</a></h2>
<p>Phương thức <code>partition</code> giúp chia mảng thành hai nhóm dựa trên một điều kiện:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">so </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">6</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">7</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">8</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">9</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Chia thành số chẵn và số lẻ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">so_chan</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> so_le </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> so</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">partition </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">n</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> n</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">even</span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># so_chan = [2, 4, 6, 8, 10]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># so_le = [1, 3, 5, 7, 9]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Ứng dụng thực tế: Phân loại sinh viên đậu/rớt</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">diem_thi </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">8.5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">6.7</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">4.2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">9.0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">5.5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">7.8</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3.9</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">dau</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> rot </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> diem_thi</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">partition </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">diem</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> diem </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">5.0</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># dau = [8.5, 6.7, 9.0, 5.5, 7.8]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># rot = [4.2, 3.9]</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-kết-hợp-map-và-compact-trong-chuỗi-xử-lý">🔗 Kết hợp map và compact trong chuỗi xử lý<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-trung-cap/#-k%E1%BA%BFt-h%E1%BB%A3p-map-v%C3%A0-compact-trong-chu%E1%BB%97i-x%E1%BB%AD-l%C3%BD" class="hash-link" aria-label="Direct link to 🔗 Kết hợp map và compact trong chuỗi xử lý" title="Direct link to 🔗 Kết hợp map và compact trong chuỗi xử lý">​</a></h2>
<p>Kết hợp các phương thức trong một chuỗi giúp code ngắn gọn và dễ đọc hơn:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">du_lieu </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"1"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"hai"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"3"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"bốn"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"5"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Chuyển đổi chuỗi thành số và loại bỏ các giá trị không hợp lệ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">so </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> du_lieu</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">map </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">s</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(86, 156, 214)">Integer</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">rescue</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">compact</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; [1, 3, 5]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Ứng dụng thực tế: Xử lý dữ liệu từ file CSV</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">du_lieu_csv </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"12.5"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"N/A"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"8.75"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"error"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"10.0"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">gia_tri </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> du_lieu_csv</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">map </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">s</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(212, 212, 212)">==</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"N/A"</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">||</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(212, 212, 212)">==</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"error"</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">nil</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(86, 156, 214)">Float</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">rescue</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">compact</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; [12.5, 8.75, 10.0]</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-truy-cập-mảng-lồng-nhau-với-dig">🔍 Truy cập mảng lồng nhau với dig<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-trung-cap/#-truy-c%E1%BA%ADp-m%E1%BA%A3ng-l%E1%BB%93ng-nhau-v%E1%BB%9Bi-dig" class="hash-link" aria-label="Direct link to 🔍 Truy cập mảng lồng nhau với dig" title="Direct link to 🔍 Truy cập mảng lồng nhau với dig">​</a></h2>
<p>Phương thức <code>dig</code> giúp truy cập an toàn vào các phần tử trong mảng lồng nhau mà không gặp lỗi <code>NoMethodError</code>:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">du_lieu_nguoi_dung </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token symbol">ten</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Minh"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token symbol">thong_tin</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token symbol">dia_chi</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token symbol">thanh_pho</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Hà Nội"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token symbol">quan</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Cầu Giấy"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token symbol">sdt</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"0912345678"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"0987654321"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token symbol">ten</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Linh"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token symbol">thong_tin</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token symbol">dia_chi</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">nil</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token symbol">sdt</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"0923456789"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Truy cập an toàn với dig</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">du_lieu_nguoi_dung</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">dig</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token symbol">:thong_tin</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">:dia_chi</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">:thanh_pho</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; "Hà Nội"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">du_lieu_nguoi_dung</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">dig</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token symbol">:thong_tin</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">:dia_chi</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">:thanh_pho</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; nil (không gây lỗi)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-tính-tổng-với-block-tùy-chỉnh">🧮 Tính tổng với block tùy chỉnh<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-trung-cap/#-t%C3%ADnh-t%E1%BB%95ng-v%E1%BB%9Bi-block-t%C3%B9y-ch%E1%BB%89nh" class="hash-link" aria-label="Direct link to 🧮 Tính tổng với block tùy chỉnh" title="Direct link to 🧮 Tính tổng với block tùy chỉnh">​</a></h2>
<p>Phương thức <code>sum</code> không chỉ dùng để cộng các số, mà còn có thể tùy chỉnh cách tính tổng:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">san_pham </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token symbol">ten</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Áo"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">gia</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">250000</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">so_luong</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token symbol">ten</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Quần"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">gia</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">350000</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">so_luong</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token symbol">ten</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Giày"</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">gia</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">500000</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token symbol">so_luong</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Tính tổng tiền</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">tong_tien </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> san_pham</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">sum </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">sp</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> sp</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token symbol">:gia</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> sp</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token symbol">:so_luong</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; 1350000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Tính tổng với giá trị khởi tạo</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">tong_tien_sau_giam_gia </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> san_pham</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">sum</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">100000</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">sp</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> sp</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token symbol">:gia</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> sp</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token symbol">:so_luong</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; 1450000 (thêm 100000 vào tổng)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-tạo-tổ-hợp-và-tích-descartes-với-product">🎲 Tạo tổ hợp và tích Descartes với product<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-trung-cap/#-t%E1%BA%A1o-t%E1%BB%95-h%E1%BB%A3p-v%C3%A0-t%C3%ADch-descartes-v%E1%BB%9Bi-product" class="hash-link" aria-label="Direct link to 🎲 Tạo tổ hợp và tích Descartes với product" title="Direct link to 🎲 Tạo tổ hợp và tích Descartes với product">​</a></h2>
<p>Phương thức <code>product</code> giúp tạo ra tất cả các cặp phần tử có thể có từ hai hoặc nhiều mảng:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">mau_ao </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'đỏ'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'xanh'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'trắng'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">kich_co </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'S'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'M'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'L'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'XL'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Tạo tất cả các kết hợp có thể</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">san_pham </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> mau_ao</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">product</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">kich_co</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; [</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#      ["đỏ", "S"], ["đỏ", "M"], ["đỏ", "L"], ["đỏ", "XL"],</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#      ["xanh", "S"], ["xanh", "M"], ["xanh", "L"], ["xanh", "XL"],</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#      ["trắng", "S"], ["trắng", "M"], ["trắng", "L"], ["trắng", "XL"]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#    ]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Tạo tổ hợp phức tạp hơn</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">chat_lieu </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'cotton'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'kaki'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">tat_ca_san_pham </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> mau_ao</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">product</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">kich_co</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> chat_lieu</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Kết quả: Mảng 3 chiều với tất cả các kết hợp có thể</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-kết-luận">🚀 Kết luận<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-ky-thuat-trung-cap/#-k%E1%BA%BFt-lu%E1%BA%ADn" class="hash-link" aria-label="Direct link to 🚀 Kết luận" title="Direct link to 🚀 Kết luận">​</a></h2>
<p>Các kỹ thuật trung cấp này sẽ giúp bạn xử lý mảng trong Ruby một cách hiệu quả và sáng tạo hơn. Việc nắm vững những phương thức này không chỉ giúp code của bạn ngắn gọn hơn mà còn tăng hiệu suất xử lý dữ liệu.</p>
<p>Hãy thử áp dụng những kỹ thuật này vào dự án của bạn và khám phá sức mạnh thực sự của mảng trong Ruby!</p>
<hr>
<p>Bạn đã sử dụng kỹ thuật nào trong số này? Hãy chia sẻ kinh nghiệm của bạn trong phần bình luận nhé!</p>]]></content:encoded>
            <category>Ruby</category>
            <category>Arrays</category>
            <category>Intermediate</category>
        </item>
        <item>
            <title><![CDATA[Khám Phá Mảng Trong Ruby: Hành Trang Cần Thiết Cho Người Mới]]></title>
            <link>https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-cho-nguoi-moi-bat-dau/</link>
            <guid>https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-cho-nguoi-moi-bat-dau/</guid>
            <pubDate>Sun, 23 Jul 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[Ruby Arrays]]></description>
            <content:encoded><![CDATA[<p><img decoding="async" loading="lazy" src="https://images.unsplash.com/photo-1522542550221-31fd19575a2d?ixlib=rb-1.2.1&amp;auto=format&amp;fit=crop&amp;w=1350&amp;q=80" alt="Ruby Arrays" class="img_VBoq"></p>
<p>Bạn mới bắt đầu với Ruby? Bạn đang loay hoay với khái niệm mảng (arrays)? Đừng lo lắng! Bài viết này sẽ giúp bạn nắm vững những kiến thức cơ bản về mảng trong Ruby một cách dễ dàng và thú vị.</p>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-tạo-mảng---bước-đầu-tiên-trong-cuộc-phiêu-lưu">🎮 Tạo mảng - Bước đầu tiên trong cuộc phiêu lưu<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-cho-nguoi-moi-bat-dau/#-t%E1%BA%A1o-m%E1%BA%A3ng---b%C6%B0%E1%BB%9Bc-%C4%91%E1%BA%A7u-ti%C3%AAn-trong-cu%E1%BB%99c-phi%C3%AAu-l%C6%B0u" class="hash-link" aria-label="Direct link to 🎮 Tạo mảng - Bước đầu tiên trong cuộc phiêu lưu" title="Direct link to 🎮 Tạo mảng - Bước đầu tiên trong cuộc phiêu lưu">​</a></h2>
<p>Trong Ruby, bạn có thể tạo mảng bằng hai cách chính: sử dụng cú pháp <code>[]</code> hoặc constructor <code>Array.new</code>. Mỗi cách có ưu điểm riêng tùy vào tình huống sử dụng.</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"># Cách 1: Sử dụng cú pháp []</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">trai_cay </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'táo'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'chuối'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'cherry'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Cách 2: Sử dụng Array.new với kích thước cố định</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">o_trong </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">Array</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">new</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">            </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; [nil, nil, nil, nil, nil]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Cách 3: Với giá trị mặc định</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">so_khong </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">Array</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">new</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; [0, 0, 0]</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-truy-cập-phần-tử---tìm-kho-báu-trong-mảng">🔍 Truy cập phần tử - Tìm kho báu trong mảng<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-cho-nguoi-moi-bat-dau/#-truy-c%E1%BA%ADp-ph%E1%BA%A7n-t%E1%BB%AD---t%C3%ACm-kho-b%C3%A1u-trong-m%E1%BA%A3ng" class="hash-link" aria-label="Direct link to 🔍 Truy cập phần tử - Tìm kho báu trong mảng" title="Direct link to 🔍 Truy cập phần tử - Tìm kho báu trong mảng">​</a></h2>
<p>Truy cập phần tử trong mảng Ruby rất linh hoạt. Bạn có thể sử dụng chỉ số dương (bắt đầu từ 0) hoặc chỉ số âm (đếm ngược từ cuối mảng).</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">mon_an </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'phở'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'bún chả'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'bánh mì'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'cơm tấm'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Truy cập bằng chỉ số dương</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">mon_an</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">      </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; 'phở'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">mon_an</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">      </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; 'bánh mì'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Truy cập bằng chỉ số âm</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">mon_an</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">     </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; 'cơm tấm' (phần tử cuối cùng)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">mon_an</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">     </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; 'bún chả'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Phương thức first và last</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">mon_an</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">first   </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; 'phở'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">mon_an</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">last    </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; 'cơm tấm'</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-thêm-và-xóa-phần-tử---điều-chỉnh-kho-báu-của-bạn">🧩 Thêm và xóa phần tử - Điều chỉnh kho báu của bạn<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-cho-nguoi-moi-bat-dau/#-th%C3%AAm-v%C3%A0-x%C3%B3a-ph%E1%BA%A7n-t%E1%BB%AD---%C4%91i%E1%BB%81u-ch%E1%BB%89nh-kho-b%C3%A1u-c%E1%BB%A7a-b%E1%BA%A1n" class="hash-link" aria-label="Direct link to 🧩 Thêm và xóa phần tử - Điều chỉnh kho báu của bạn" title="Direct link to 🧩 Thêm và xóa phần tử - Điều chỉnh kho báu của bạn">​</a></h2>
<p>Ruby cung cấp nhiều phương thức để thêm và xóa phần tử trong mảng:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">danh_sach </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'học Ruby'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'làm bài tập'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Thêm phần tử vào cuối mảng</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">danh_sach</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">push</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'đọc sách'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; ['học Ruby', 'làm bài tập', 'đọc sách']</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">danh_sach </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;&lt;</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'nghe nhạc'</span><span class="token plain">          </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; ['học Ruby', 'làm bài tập', 'đọc sách', 'nghe nhạc']</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Thêm phần tử vào đầu mảng</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">danh_sach</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">unshift</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'thức dậy sớm'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; ['thức dậy sớm', 'học Ruby', 'làm bài tập', 'đọc sách', 'nghe nhạc']</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Xóa phần tử cuối cùng</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">phan_tu_cuoi </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> danh_sach</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">pop      </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; 'nghe nhạc'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Xóa phần tử đầu tiên</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">phan_tu_dau </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> danh_sach</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">shift     </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; 'thức dậy sớm'</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-lặp-qua-mảng---khám-phá-từng-ngóc-ngách">🔄 Lặp qua mảng - Khám phá từng ngóc ngách<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-cho-nguoi-moi-bat-dau/#-l%E1%BA%B7p-qua-m%E1%BA%A3ng---kh%C3%A1m-ph%C3%A1-t%E1%BB%ABng-ng%C3%B3c-ng%C3%A1ch" class="hash-link" aria-label="Direct link to 🔄 Lặp qua mảng - Khám phá từng ngóc ngách" title="Direct link to 🔄 Lặp qua mảng - Khám phá từng ngóc ngách">​</a></h2>
<p>Duyệt qua các phần tử trong mảng là một thao tác phổ biến. Ruby cung cấp nhiều cách để thực hiện điều này:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">mau_sac </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'đỏ'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'xanh lá'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'vàng'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'tím'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Sử dụng each</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">mau_sac</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">each</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">mau</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  puts </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Tôi thích màu </span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">#{</span><span class="token string-literal interpolation content">mau</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Sử dụng each_with_index</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">mau_sac</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">each_with_index </span><span class="token keyword" style="color:rgb(86, 156, 214)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">mau</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> index</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  puts </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"Màu thứ </span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">#{</span><span class="token string-literal interpolation content">index </span><span class="token string-literal interpolation content operator" style="color:rgb(212, 212, 212)">+</span><span class="token string-literal interpolation content"> </span><span class="token string-literal interpolation content number" style="color:rgb(181, 206, 168)">1</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-literal string" style="color:rgb(206, 145, 120)"> là: </span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">#{</span><span class="token string-literal interpolation content">mau</span><span class="token string-literal interpolation delimiter punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-literal string" style="color:rgb(206, 145, 120)">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-biến-đổi-mảng---phép-thuật-với-map-và-select">🧪 Biến đổi mảng - Phép thuật với map và select<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-cho-nguoi-moi-bat-dau/#-bi%E1%BA%BFn-%C4%91%E1%BB%95i-m%E1%BA%A3ng---ph%C3%A9p-thu%E1%BA%ADt-v%E1%BB%9Bi-map-v%C3%A0-select" class="hash-link" aria-label="Direct link to 🧪 Biến đổi mảng - Phép thuật với map và select" title="Direct link to 🧪 Biến đổi mảng - Phép thuật với map và select">​</a></h2>
<p>Ruby cung cấp các phương thức mạnh mẽ để biến đổi mảng:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">so </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Sử dụng map để biến đổi mỗi phần tử</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">binh_phuong </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> so</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">map </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">n</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> n </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> n </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; [1, 4, 9, 16, 25]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Sử dụng select để lọc phần tử</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">so_chan </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> so</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">select </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain">n</span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> n</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">even</span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; [2, 4]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Kết hợp các mảng</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">so_khac </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">6</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">7</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">8</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">tat_ca </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> so </span><span class="token operator" style="color:rgb(212, 212, 212)">+</span><span class="token plain"> so_khac              </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; [1, 2, 3, 4, 5, 6, 7, 8]</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-làm-sạch-mảng---dọn-dẹp-kho-báu">🧹 Làm sạch mảng - Dọn dẹp kho báu<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-cho-nguoi-moi-bat-dau/#-l%C3%A0m-s%E1%BA%A1ch-m%E1%BA%A3ng---d%E1%BB%8Dn-d%E1%BA%B9p-kho-b%C3%A1u" class="hash-link" aria-label="Direct link to 🧹 Làm sạch mảng - Dọn dẹp kho báu" title="Direct link to 🧹 Làm sạch mảng - Dọn dẹp kho báu">​</a></h2>
<p>Đôi khi bạn cần loại bỏ các phần tử không mong muốn:</p>
<div class="language-ruby codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-ruby codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">du_lieu </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">nil</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">nil</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'a'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(206, 145, 120)">'b'</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">nil</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Loại bỏ nil</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">du_lieu_sach </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> du_lieu</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">compact    </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; [1, 2, 3, 'a', 'b']</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Loại bỏ phần tử trùng lặp</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">mang_trung </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">mang_duy_nhat </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> mang_trung</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">uniq   </span><span class="token comment" style="color:rgb(106, 153, 85)"># =&gt; [1, 2, 3, 4]</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="-kết-luận">🎯 Kết luận<a href="https://ojisanchamchi.github.io/keep-being-human-dev/blog/ruby-arrays-cho-nguoi-moi-bat-dau/#-k%E1%BA%BFt-lu%E1%BA%ADn" class="hash-link" aria-label="Direct link to 🎯 Kết luận" title="Direct link to 🎯 Kết luận">​</a></h2>
<p>Mảng là một trong những cấu trúc dữ liệu cơ bản và quan trọng nhất trong Ruby. Nắm vững cách sử dụng mảng sẽ giúp bạn xây dựng các ứng dụng Ruby hiệu quả hơn. Hãy thực hành các ví dụ trên và khám phá thêm các phương thức khác của mảng trong Ruby.</p>
<p>Bạn đã sẵn sàng tiến xa hơn trong hành trình học Ruby? Hãy theo dõi các bài viết tiếp theo của chúng tôi về các chủ đề nâng cao hơn!</p>
<hr>
<p>Bạn có câu hỏi hoặc ý kiến? Hãy để lại bình luận bên dưới nhé!</p>]]></content:encoded>
            <category>Ruby</category>
            <category>Arrays</category>
            <category>Beginner</category>
        </item>
    </channel>
</rss>