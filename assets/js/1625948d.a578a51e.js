"use strict";(self.webpackChunkkeep_being_human_dev=self.webpackChunkkeep_being_human_dev||[]).push([[84390],{65404:(e,t,r)=>{r.d(t,{R:()=>s,x:()=>l});var a=r(36672);const n={},i=a.createContext(n);function s(e){const t=a.useContext(i);return a.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:s(e.components),a.createElement(i.Provider,{value:t},e.children)}},88883:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>o,contentTitle:()=>l,default:()=>p,frontMatter:()=>s,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"rails/active_storage/expert/resumable_multipart_upload","title":"resumable_multipart_upload","description":"\ud83d\ude80 Implementing Resumable Direct Uploads with S3 Multipart","source":"@site/docs/rails/active_storage/expert/resumable_multipart_upload.md","sourceDirName":"rails/active_storage/expert","slug":"/rails/active_storage/expert/resumable_multipart_upload","permalink":"/keep-being-human-dev/docs/rails/active_storage/expert/resumable_multipart_upload","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/rails/active_storage/expert/resumable_multipart_upload.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"mirror_service_fallback","permalink":"/keep-being-human-dev/docs/rails/active_storage/expert/mirror_service_fallback"},"next":{"title":"direct_uploads_with_javascript","permalink":"/keep-being-human-dev/docs/rails/active_storage/middle/direct_uploads_with_javascript"}}');var n=r(23420),i=r(65404);const s={},l=void 0,o={},c=[{value:"\ud83d\ude80 Implementing Resumable Direct Uploads with S3 Multipart",id:"-implementing-resumable-direct-uploads-with-s3-multipart",level:2}];function d(e){const t={code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h2,{id:"-implementing-resumable-direct-uploads-with-s3-multipart",children:"\ud83d\ude80 Implementing Resumable Direct Uploads with S3 Multipart"}),"\n",(0,n.jsx)(t.p,{children:"For multi\u2011GB files, enable S3\u2019s multipart upload and hook into Active Storage\u2019s JS events to show resumable progress and retry segments on failure."}),"\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsxs)(t.li,{children:["Configure multipart in ",(0,n.jsx)(t.code,{children:"config/storage.yml"}),":"]}),"\n"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-yaml",children:"amazon:\n  service: S3\n  multipart: true\n  bucket: <%= ENV['S3_BUCKET'] %>\n  upload: :multipart\n"})}),"\n",(0,n.jsxs)(t.ol,{start:"2",children:["\n",(0,n.jsxs)(t.li,{children:["Add JavaScript listeners (e.g., ",(0,n.jsx)(t.code,{children:"app/javascript/packs/active_storage_uploads.js"}),"):"]}),"\n"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-javascript",children:'import * as ActiveStorage from "@rails/activestorage"\nActiveStorage.start()\n\ndocument.addEventListener("direct-upload:initialize", event => {\n  const { id, file } = event.detail\n  console.log(`Starting upload ${id} for ${file.name}`)\n})\n\ndocument.addEventListener("direct-upload:progress", event => {\n  const { id, progress } = event.detail\n  document.querySelector(`#upload-${id} .progress`).style.width = `${progress}%`\n})\n\ndocument.addEventListener("direct-upload:error", event => {\n  console.error("Upload failed:", event.detail.error)\n  // Retry logic or user prompt\n})\n'})})]})}function p(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}}}]);