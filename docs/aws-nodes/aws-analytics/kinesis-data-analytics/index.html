<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-aws-nodes/aws-analytics/kinesis-data-analytics" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Amazon Kinesis Data Analytics | Keep Being Human</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://ojisanchamchi.github.io/keep-being-human-dev/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://ojisanchamchi.github.io/keep-being-human-dev/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://ojisanchamchi.github.io/keep-being-human-dev/docs/aws-nodes/aws-analytics/kinesis-data-analytics/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Amazon Kinesis Data Analytics | Keep Being Human"><meta data-rh="true" name="description" content="Tổng quan"><meta data-rh="true" property="og:description" content="Tổng quan"><link data-rh="true" rel="icon" href="/keep-being-human-dev/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://ojisanchamchi.github.io/keep-being-human-dev/docs/aws-nodes/aws-analytics/kinesis-data-analytics/"><link data-rh="true" rel="alternate" href="https://ojisanchamchi.github.io/keep-being-human-dev/docs/aws-nodes/aws-analytics/kinesis-data-analytics/" hreflang="en"><link data-rh="true" rel="alternate" href="https://ojisanchamchi.github.io/keep-being-human-dev/docs/aws-nodes/aws-analytics/kinesis-data-analytics/" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"AWS Nodes","item":"https://ojisanchamchi.github.io/keep-being-human-dev/docs/category/aws-nodes"},{"@type":"ListItem","position":2,"name":"AWS Analytics Nodes","item":"https://ojisanchamchi.github.io/keep-being-human-dev/docs/category/aws-analytics-nodes"},{"@type":"ListItem","position":3,"name":"Amazon Kinesis Data Analytics","item":"https://ojisanchamchi.github.io/keep-being-human-dev/docs/aws-nodes/aws-analytics/kinesis-data-analytics"}]}</script><link rel="alternate" type="application/rss+xml" href="/keep-being-human-dev/blog/rss.xml" title="Keep Being Human RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/keep-being-human-dev/blog/atom.xml" title="Keep Being Human Atom Feed"><link rel="stylesheet" href="/keep-being-human-dev/assets/css/styles.5d4f9dac.css">
<script src="/keep-being-human-dev/assets/js/runtime~main.bc0eac6b.js" defer="defer"></script>
<script src="/keep-being-human-dev/assets/js/main.36535a00.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/keep-being-human-dev/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_dyf1" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/keep-being-human-dev/"><div class="navbar__logo"><img src="/keep-being-human-dev/img/logo.svg" alt="Keep Being Human Logo" class="themedComponent_ogAL themedComponent--light__wdf"><img src="/keep-being-human-dev/img/logo.svg" alt="Keep Being Human Logo" class="themedComponent_ogAL themedComponent--dark_SEbq"></div><b class="navbar__title text--truncate">Keep Being Human</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/keep-being-human-dev/docs/intro/">Tutorial</a><a class="navbar__item navbar__link" href="/keep-being-human-dev/blog/">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/ojisanchamchi/keep-being-human-dev" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink__HqX"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_d9FJ colorModeToggle_OvZq"><button class="clean-btn toggleButton_YeW3 toggleButtonDisabled_axyx" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_Ubto lightToggleIcon_kqz0"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_Ubto darkToggleIcon_AfVN"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_Ubto systemToggleIcon_qH6u"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_NnjY"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_DTfW"><div class="docsWrapper_JsRM"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_Ea1r" type="button"></button><div class="docRoot_DkWP"><aside class="theme-doc-sidebar-container docSidebarContainer_AsaM"><div class="sidebarViewport_SYRt"><div class="sidebar_cnSe"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_Ac8k"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/keep-being-human-dev/docs/intro/">Hướng Dẫn Sử Dụng Tài Liệu Ruby</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/keep-being-human-dev/docs/category/aws-nodes/">AWS Nodes</a><button aria-label="Collapse sidebar category &#x27;AWS Nodes&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/keep-being-human-dev/docs/category/aws-analytics-nodes/">AWS Analytics Nodes</a><button aria-label="Collapse sidebar category &#x27;AWS Analytics Nodes&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/keep-being-human-dev/docs/aws-nodes/aws-analytics/amazon-opensearch-service/">Amazon OpenSearch Service</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/keep-being-human-dev/docs/aws-nodes/aws-analytics/analytics/">AWS Analytics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/keep-being-human-dev/docs/aws-nodes/aws-analytics/athena/">Amazon Athena</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/keep-being-human-dev/docs/aws-nodes/aws-analytics/cloudsearch-search-documents/">CloudSearch Search Documents</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/keep-being-human-dev/docs/aws-nodes/aws-analytics/cloudsearch/">Amazon CloudSearch</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/keep-being-human-dev/docs/aws-nodes/aws-analytics/data-lake-resource/">Data Lake Resource</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/keep-being-human-dev/docs/aws-nodes/aws-analytics/data-pipeline/">AWS Data Pipeline</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/keep-being-human-dev/docs/aws-nodes/aws-analytics/elasticsearch-service/">Amazon Elasticsearch Service</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/keep-being-human-dev/docs/aws-nodes/aws-analytics/emr-cluster/">EMR Cluster</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/keep-being-human-dev/docs/aws-nodes/aws-analytics/emr-engine-mapr-m3/">EMR Engine MapR M3</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/keep-being-human-dev/docs/aws-nodes/aws-analytics/emr-engine-mapr-m5/">EMR Engine MapR M5</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/keep-being-human-dev/docs/aws-nodes/aws-analytics/emr-engine-mapr-m7/">EMR Engine MapR M7</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/keep-being-human-dev/docs/aws-nodes/aws-analytics/emr-engine/">EMR Engine</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/keep-being-human-dev/docs/aws-nodes/aws-analytics/emr-hdfs-cluster/">EMR HDFS Cluster</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/keep-being-human-dev/docs/aws-nodes/aws-analytics/emr/">Amazon EMR</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/keep-being-human-dev/docs/aws-nodes/aws-analytics/glue-crawlers/">AWS Glue Crawlers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/keep-being-human-dev/docs/aws-nodes/aws-analytics/glue-data-catalog/">AWS Glue Data Catalog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/keep-being-human-dev/docs/aws-nodes/aws-analytics/glue/">AWS Glue</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/keep-being-human-dev/docs/aws-nodes/aws-analytics/kinesis-data-analytics/">Amazon Kinesis Data Analytics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/keep-being-human-dev/docs/aws-nodes/aws-analytics/kinesis-data-firehose/">Amazon Kinesis Data Firehose</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/keep-being-human-dev/docs/aws-nodes/aws-analytics/kinesis-data-streams/">Amazon Kinesis Data Streams</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/keep-being-human-dev/docs/aws-nodes/aws-analytics/kinesis-video-streams/">Amazon Kinesis Video Streams</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/keep-being-human-dev/docs/aws-nodes/aws-analytics/kinesis/">Amazon Kinesis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/keep-being-human-dev/docs/aws-nodes/aws-analytics/lake-formation/">AWS Lake Formation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/keep-being-human-dev/docs/aws-nodes/aws-analytics/managed-streaming-for-kafka/">Amazon Managed Streaming for Apache Kafka (MSK)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/keep-being-human-dev/docs/aws-nodes/aws-analytics/quicksight/">Amazon QuickSight</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/keep-being-human-dev/docs/aws-nodes/aws-analytics/redshift-dense-compute-node/">Amazon Redshift Dense Compute Node</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/keep-being-human-dev/docs/aws-nodes/aws-analytics/redshift-dense-storage-node/">Amazon Redshift Dense Storage Node</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/keep-being-human-dev/docs/aws-nodes/aws-analytics/redshift/">Amazon Redshift</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/keep-being-human-dev/docs/aws-nodes/aws-analytics/">AWS Analytics Nodes</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/keep-being-human-dev/docs/aws-nodes/">AWS Nodes</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/keep-being-human-dev/docs/diagrams/digitalocean/">diagrams</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/keep-being-human-dev/docs/gems/acts-as-taggable-on/advanced/custom_delimiters_unicode_normalization/">gems</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/keep-being-human-dev/docs/javascript/hotwire/advanced/advanced_turbo_stream_targets/">javascript</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/keep-being-human-dev/docs/nosql/redis/advanced/redis_lua_scripting/">nosql</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/keep-being-human-dev/docs/rails/action_cable/advanced/chunked_streaming/">rails</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/keep-being-human-dev/docs/ruby/arrays/advanced/balanced_chunk_split/">ruby</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/keep-being-human-dev/docs/sql/general/advanced/expression_and_partial_indexes/">sql</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_QNjX"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_ml7c"><div class="docItemContainer_tjc6"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_EvcW" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/keep-being-human-dev/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_UfOY"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/keep-being-human-dev/docs/category/aws-nodes/"><span>AWS Nodes</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/keep-being-human-dev/docs/category/aws-analytics-nodes/"><span>AWS Analytics Nodes</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Amazon Kinesis Data Analytics</span></li></ul></nav><div class="tocCollapsible__GRc theme-doc-toc-mobile tocMobile_OQBc"><button type="button" class="clean-btn tocCollapsibleButton_mliV">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Amazon Kinesis Data Analytics</h1></header>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="tổng-quan">Tổng quan<a href="#tổng-quan" class="hash-link" aria-label="Direct link to Tổng quan" title="Direct link to Tổng quan">​</a></h2>
<p>Amazon Kinesis Data Analytics là node đại diện cho dịch vụ phân tích dữ liệu streaming real-time của AWS. Dịch vụ này cho phép bạn xử lý và phân tích streaming data bằng SQL hoặc Apache Flink, cung cấp khả năng tạo insights từ dữ liệu đang chuyển động mà không cần quản lý infrastructure phức tạp.</p>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="chức-năng-chính">Chức năng chính<a href="#chức-năng-chính" class="hash-link" aria-label="Direct link to Chức năng chính" title="Direct link to Chức năng chính">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_aa2m" id="1-real-time-stream-processing">1. Real-time Stream Processing<a href="#1-real-time-stream-processing" class="hash-link" aria-label="Direct link to 1. Real-time Stream Processing" title="Direct link to 1. Real-time Stream Processing">​</a></h3>
<ul>
<li><strong>SQL Queries</strong>: Xử lý streaming data bằng SQL chuẩn</li>
<li><strong>Apache Flink</strong>: Advanced stream processing với Flink applications</li>
<li><strong>Windowing Functions</strong>: Time-based và count-based windows</li>
<li><strong>Pattern Detection</strong>: Phát hiện patterns trong streaming data</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_aa2m" id="2-multiple-runtime-environments">2. Multiple Runtime Environments<a href="#2-multiple-runtime-environments" class="hash-link" aria-label="Direct link to 2. Multiple Runtime Environments" title="Direct link to 2. Multiple Runtime Environments">​</a></h3>
<ul>
<li><strong>SQL Runtime</strong>: Serverless SQL-based analytics</li>
<li><strong>Apache Flink Runtime</strong>: Java/Scala applications với Flink</li>
<li><strong>Apache Beam</strong>: Portable data processing pipelines</li>
<li><strong>Managed Scaling</strong>: Tự động scale based on throughput</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_aa2m" id="3-data-sources-integration">3. Data Sources Integration<a href="#3-data-sources-integration" class="hash-link" aria-label="Direct link to 3. Data Sources Integration" title="Direct link to 3. Data Sources Integration">​</a></h3>
<ul>
<li><strong>Kinesis Data Streams</strong>: Direct integration với data streams</li>
<li><strong>Kinesis Data Firehose</strong>: Processed data delivery</li>
<li><strong>Amazon MSK</strong>: Apache Kafka integration</li>
<li><strong>Reference Data</strong>: Static data joins từ S3</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_aa2m" id="4-output-destinations">4. Output Destinations<a href="#4-output-destinations" class="hash-link" aria-label="Direct link to 4. Output Destinations" title="Direct link to 4. Output Destinations">​</a></h3>
<ul>
<li><strong>Real-time Dashboards</strong>: Live analytics dashboards</li>
<li><strong>Data Lakes</strong>: Processed data to S3</li>
<li><strong>Databases</strong>: Results to RDS, DynamoDB</li>
<li><strong>Alerting Systems</strong>: Notifications via SNS, Lambda</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="use-cases-phổ-biến">Use Cases phổ biến<a href="#use-cases-phổ-biến" class="hash-link" aria-label="Direct link to Use Cases phổ biến" title="Direct link to Use Cases phổ biến">​</a></h2>
<ol>
<li><strong>Real-time Fraud Detection</strong>: Phát hiện gian lận tức thời</li>
<li><strong>IoT Analytics</strong>: Phân tích dữ liệu IoT real-time</li>
<li><strong>Clickstream Analysis</strong>: Phân tích hành vi người dùng</li>
<li><strong>Log Analytics</strong>: Xử lý và phân tích logs real-time</li>
<li><strong>Financial Trading</strong>: Real-time market data analysis</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="diagram-architecture">Diagram Architecture<a href="#diagram-architecture" class="hash-link" aria-label="Direct link to Diagram Architecture" title="Direct link to Diagram Architecture">​</a></h2>
<p>Kiến trúc Amazon Kinesis Data Analytics với real-time processing:</p>
<p><img decoding="async" loading="lazy" alt="Amazon Kinesis Data Analytics Architecture" src="/keep-being-human-dev/assets/images/kinesis-data-analytics-cf4c2e9dce83774989c74355909a5671.png" width="2101" height="1811" class="img_VBoq"></p>
<h3 class="anchor anchorWithStickyNavbar_aa2m" id="code-để-tạo-diagram">Code để tạo diagram:<a href="#code-để-tạo-diagram" class="hash-link" aria-label="Direct link to Code để tạo diagram:" title="Direct link to Code để tạo diagram:">​</a></h3>
<div class="language-python codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-python codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> diagrams </span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> Diagram</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> Cluster</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> Edge</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> diagrams</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">aws</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">analytics </span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> KinesisDataAnalytics</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> KinesisDataStreams</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> KinesisDataFirehose</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> diagrams</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">aws</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">storage </span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> S3</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> diagrams</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">aws</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">compute </span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> Lambda</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> diagrams</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">aws</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">database </span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> RDS</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> Dynamodb</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> diagrams</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">aws</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">integration </span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> SQS</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> SNS</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> diagrams</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">aws</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">management </span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> Cloudwatch</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> diagrams</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">aws</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">security </span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> IAM</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> diagrams</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">onprem</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">client </span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> Users</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> diagrams</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">onprem</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">analytics </span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> Flink</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">with</span><span class="token plain"> Diagram</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Amazon Kinesis Data Analytics Architecture&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> show</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token boolean">False</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> direction</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;TB&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    users </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Users</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Business Users&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">with</span><span class="token plain"> Cluster</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Data Sources&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        web_apps </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Lambda</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Web Applications&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        mobile_apps </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Lambda</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Mobile Apps&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        iot_devices </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Lambda</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;IoT Devices&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        log_sources </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Lambda</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Log Sources&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">with</span><span class="token plain"> Cluster</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Streaming Ingestion&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        data_streams </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> KinesisDataStreams</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Kinesis Data Streams&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        firehose </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> KinesisDataFirehose</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Kinesis Data Firehose&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        kafka_source </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> SQS</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Apache Kafka/MSK&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">with</span><span class="token plain"> Cluster</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Stream Processing&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        analytics_app </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> KinesisDataAnalytics</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Kinesis Data Analytics&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">with</span><span class="token plain"> Cluster</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Processing Engines&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            sql_runtime </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> KinesisDataAnalytics</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;SQL Runtime&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            flink_runtime </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Flink</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Flink Runtime&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            beam_runtime </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Lambda</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Beam Runtime&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">with</span><span class="token plain"> Cluster</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Reference Data&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        s3_reference </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> S3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Reference Data&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        lookup_tables </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Dynamodb</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Lookup Tables&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">with</span><span class="token plain"> Cluster</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Real-time Outputs&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        real_time_dashboard </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Lambda</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Real-time Dashboard&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        alerts </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> SNS</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Real-time Alerts&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        lambda_functions </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Lambda</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Lambda Functions&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        kinesis_output </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> KinesisDataStreams</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Output Streams&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">with</span><span class="token plain"> Cluster</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Batch Outputs&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        s3_results </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> S3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Analytics Results&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        data_warehouse </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> RDS</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Data Warehouse&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        firehose_output </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> KinesisDataFirehose</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Delivery Streams&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">with</span><span class="token plain"> Cluster</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Monitoring &amp; Management&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        cloudwatch </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Cloudwatch</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;CloudWatch&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        security </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> IAM</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;IAM Roles&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># Data ingestion flow</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    web_apps </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> Edge</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">label</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Events&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> data_streams</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    mobile_apps </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> Edge</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">label</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Analytics&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> data_streams</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    iot_devices </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> Edge</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">label</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Sensor Data&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> data_streams</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    log_sources </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> Edge</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">label</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Logs&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> firehose</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># Stream processing input</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    data_streams </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> Edge</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">label</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Stream Data&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> analytics_app</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    firehose </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> Edge</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">label</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Buffered Data&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> analytics_app</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    kafka_source </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> Edge</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">label</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Kafka Topics&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> analytics_app</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># Processing engines</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    analytics_app </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> sql_runtime</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    analytics_app </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> flink_runtime</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    analytics_app </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> beam_runtime</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># Reference data joins</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    s3_reference </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> Edge</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">label</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Static Data&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> analytics_app</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    lookup_tables </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> Edge</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">label</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Lookups&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> analytics_app</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># Real-time outputs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    sql_runtime </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> real_time_dashboard</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    flink_runtime </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> alerts</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    beam_runtime </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> lambda_functions</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    analytics_app </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> kinesis_output</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># Batch outputs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    analytics_app </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> firehose_output </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> s3_results</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    analytics_app </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> Edge</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">label</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Aggregated Results&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> data_warehouse</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># User interaction</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    users </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> Edge</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">label</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;View Dashboards&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> real_time_dashboard</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    users </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> Edge</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">label</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Receive Alerts&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> alerts</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># Monitoring and security</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    analytics_app </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> Edge</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">label</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Metrics&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> cloudwatch</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    security </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> Edge</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">label</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Access Control&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> analytics_app</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="sql-based-analytics">SQL-based Analytics<a href="#sql-based-analytics" class="hash-link" aria-label="Direct link to SQL-based Analytics" title="Direct link to SQL-based Analytics">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_aa2m" id="1-stream-processing-với-sql">1. Stream Processing với SQL<a href="#1-stream-processing-với-sql" class="hash-link" aria-label="Direct link to 1. Stream Processing với SQL" title="Direct link to 1. Stream Processing với SQL">​</a></h3>
<div class="language-sql codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-sql codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">-- Real-time fraud detection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">CREATE</span><span class="token plain"> STREAM fraud_detection_stream </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    transaction_id </span><span class="token keyword" style="color:rgb(86, 156, 214)">VARCHAR</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">50</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    user_id </span><span class="token keyword" style="color:rgb(86, 156, 214)">VARCHAR</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">50</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    amount </span><span class="token keyword" style="color:rgb(86, 156, 214)">DECIMAL</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    merchant_category </span><span class="token keyword" style="color:rgb(86, 156, 214)">VARCHAR</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">20</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    location </span><span class="token keyword" style="color:rgb(86, 156, 214)">VARCHAR</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">100</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">timestamp</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">TIMESTAMP</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    ROWTIME </span><span class="token keyword" style="color:rgb(86, 156, 214)">TIMESTAMP</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Detect suspicious patterns</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">CREATE</span><span class="token plain"> STREAM suspicious_transactions </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    user_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">COUNT</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">as</span><span class="token plain"> transaction_count</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">SUM</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">amount</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">as</span><span class="token plain"> total_amount</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">AVG</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">amount</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">as</span><span class="token plain"> avg_amount</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    ROWTIME_RANGE_START </span><span class="token keyword" style="color:rgb(86, 156, 214)">as</span><span class="token plain"> window_start</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    ROWTIME_RANGE_END </span><span class="token keyword" style="color:rgb(86, 156, 214)">as</span><span class="token plain"> window_end</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> SOURCE_SQL_STREAM_001</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">WHERE</span><span class="token plain"> amount </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    user_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    RANGE_INTERVAL </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;5&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">MINUTE</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Alert on anomalies</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">CREATE</span><span class="token plain"> STREAM fraud_alerts </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    user_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    transaction_count</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    total_amount</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;HIGH_VELOCITY&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">as</span><span class="token plain"> alert_type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    window_start</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> suspicious_transactions</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">WHERE</span><span class="token plain"> transaction_count </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   </span><span class="token operator" style="color:rgb(212, 212, 212)">OR</span><span class="token plain"> total_amount </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">50000</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_aa2m" id="2-windowing-functions">2. Windowing Functions<a href="#2-windowing-functions" class="hash-link" aria-label="Direct link to 2. Windowing Functions" title="Direct link to 2. Windowing Functions">​</a></h3>
<div class="language-sql codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-sql codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">-- Tumbling window (non-overlapping)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">CREATE</span><span class="token plain"> STREAM hourly_metrics </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    merchant_category</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">COUNT</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">as</span><span class="token plain"> transaction_count</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">SUM</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">amount</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">as</span><span class="token plain"> total_revenue</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">AVG</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">amount</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">as</span><span class="token plain"> avg_transaction_size</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    ROWTIME_RANGE_START </span><span class="token keyword" style="color:rgb(86, 156, 214)">as</span><span class="token plain"> hour_start</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> SOURCE_SQL_STREAM_001</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    merchant_category</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    RANGE_INTERVAL </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;1&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">HOUR</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Sliding window (overlapping)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">CREATE</span><span class="token plain"> STREAM sliding_averages </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    user_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">AVG</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">amount</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">as</span><span class="token plain"> moving_avg_5min</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">COUNT</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">as</span><span class="token plain"> transaction_count_5min</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    ROWTIME </span><span class="token keyword" style="color:rgb(86, 156, 214)">as</span><span class="token plain"> event_time</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> SOURCE_SQL_STREAM_001</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    user_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    RANGE_INTERVAL </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;5&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">MINUTE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">PRECEDING</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Session window (gap-based)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">CREATE</span><span class="token plain"> STREAM user_sessions </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    user_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">COUNT</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">as</span><span class="token plain"> actions_in_session</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">MIN</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">ROWTIME</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">as</span><span class="token plain"> session_start</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">MAX</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">ROWTIME</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">as</span><span class="token plain"> session_end</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">MAX</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">ROWTIME</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">MIN</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">ROWTIME</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">MINUTE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">as</span><span class="token plain"> session_duration</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> SOURCE_SQL_STREAM_001</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    user_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    SESSION_INTERVAL </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;30&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">MINUTE</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_aa2m" id="3-reference-data-joins">3. Reference Data Joins<a href="#3-reference-data-joins" class="hash-link" aria-label="Direct link to 3. Reference Data Joins" title="Direct link to 3. Reference Data Joins">​</a></h3>
<div class="language-sql codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-sql codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">-- Join streaming data with reference data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">CREATE</span><span class="token plain"> STREAM enriched_transactions </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    t</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">transaction_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    t</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">user_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    t</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">amount</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    t</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">merchant_category</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    u</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">user_tier</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    u</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">risk_score</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    u</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">registration_date</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">CASE</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">WHEN</span><span class="token plain"> u</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">user_tier </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;PREMIUM&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">AND</span><span class="token plain"> t</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">amount </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> u</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">daily_limit </span><span class="token keyword" style="color:rgb(86, 156, 214)">THEN</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;REVIEW&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">WHEN</span><span class="token plain"> u</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">risk_score </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0.8</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">THEN</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;HIGH_RISK&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">ELSE</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;NORMAL&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">END</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">as</span><span class="token plain"> transaction_status</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> SOURCE_SQL_STREAM_001 t</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">LEFT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">JOIN</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;USER_REFERENCE_DATA&quot;</span><span class="token plain"> u</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">ON</span><span class="token plain"> t</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">user_id </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> u</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">user_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="apache-flink-applications">Apache Flink Applications<a href="#apache-flink-applications" class="hash-link" aria-label="Direct link to Apache Flink Applications" title="Direct link to Apache Flink Applications">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_aa2m" id="1-flink-datastream-api">1. Flink DataStream API<a href="#1-flink-datastream-api" class="hash-link" aria-label="Direct link to 1. Flink DataStream API" title="Direct link to 1. Flink DataStream API">​</a></h3>
<div class="language-java codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-java codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">// Flink application for complex event processing</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">public class FraudDetectionApp {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    public static void main(String[] args) throws Exception {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        // Configure checkpointing</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        env.enableCheckpointing(60000);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        env.getCheckpointConfig().setCheckpointingMode(CheckpointingMode.EXACTLY_ONCE);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        // Read from Kinesis Data Streams</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        Properties kinesisProps = new Properties();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        kinesisProps.setProperty(ConsumerConfigConstants.AWS_REGION, &quot;us-west-2&quot;);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        kinesisProps.setProperty(ConsumerConfigConstants.STREAM_INITIAL_POSITION, &quot;LATEST&quot;);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        DataStream&lt;Transaction&gt; transactions = env</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            .addSource(new FlinkKinesisConsumer&lt;&gt;(&quot;transaction-stream&quot;, </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                                                 new TransactionDeserializer(), </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                                                 kinesisProps))</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            .assignTimestampsAndWatermarks(</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                WatermarkStrategy.&lt;Transaction&gt;forBoundedOutOfOrderness(Duration.ofSeconds(10))</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                    .withTimestampAssigner((transaction, timestamp) -&gt; transaction.getTimestamp())</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        // Fraud detection logic</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        DataStream&lt;FraudAlert&gt; alerts = transactions</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            .keyBy(Transaction::getUserId)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            .process(new FraudDetectionFunction())</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            .filter(alert -&gt; alert.getRiskScore() &gt; 0.8);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        // Output to multiple sinks</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        alerts.addSink(new FlinkKinesisProducer&lt;&gt;(&quot;fraud-alerts-stream&quot;, </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                                                 new AlertSerializer(), </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                                                 kinesisProps));</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        alerts.addSink(new DynamoDBSink&lt;&gt;(&quot;fraud-alerts-table&quot;));</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        env.execute(&quot;Real-time Fraud Detection&quot;);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">// Custom process function for fraud detection</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">public class FraudDetectionFunction extends KeyedProcessFunction&lt;String, Transaction, FraudAlert&gt; {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    private ValueState&lt;TransactionProfile&gt; profileState;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    private MapState&lt;Long, Integer&gt; hourlyCountState;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    public void open(Configuration parameters) {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        profileState = getRuntimeContext().getState(</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            new ValueStateDescriptor&lt;&gt;(&quot;profile&quot;, TransactionProfile.class)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        hourlyCountState = getRuntimeContext().getMapState(</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            new MapStateDescriptor&lt;&gt;(&quot;hourly-count&quot;, Long.class, Integer.class)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    public void processElement(Transaction transaction, Context ctx, Collector&lt;FraudAlert&gt; out) </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            throws Exception {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        TransactionProfile profile = profileState.value();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        if (profile == null) {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            profile = new TransactionProfile();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        // Update profile with new transaction</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        profile.updateWith(transaction);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        profileState.update(profile);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        // Check for velocity-based fraud</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        long hourWindow = transaction.getTimestamp() / (60 * 60 * 1000);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        Integer hourlyCount = hourlyCountState.get(hourWindow);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        hourlyCount = (hourlyCount == null) ? 1 : hourlyCount + 1;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        hourlyCountState.put(hourWindow, hourlyCount);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        // Generate alert if suspicious</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        if (hourlyCount &gt; 50 || transaction.getAmount() &gt; profile.getAverageAmount() * 10) {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            FraudAlert alert = new FraudAlert(</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                transaction.getUserId(),</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                transaction.getTransactionId(),</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                calculateRiskScore(transaction, profile, hourlyCount),</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                &quot;VELOCITY_FRAUD&quot;,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                System.currentTimeMillis()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            out.collect(alert);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        // Clean up old hourly counts</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        cleanupOldCounts(ctx.timestamp());</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    private double calculateRiskScore(Transaction transaction, TransactionProfile profile, int hourlyCount) {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        double velocityScore = Math.min(hourlyCount / 50.0, 1.0);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        double amountScore = Math.min(transaction.getAmount() / profile.getMaxAmount(), 1.0);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        double locationScore = profile.isNewLocation(transaction.getLocation()) ? 0.5 : 0.0;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        return (velocityScore * 0.4) + (amountScore * 0.4) + (locationScore * 0.2);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_aa2m" id="2-complex-event-processing-cep">2. Complex Event Processing (CEP)<a href="#2-complex-event-processing-cep" class="hash-link" aria-label="Direct link to 2. Complex Event Processing (CEP)" title="Direct link to 2. Complex Event Processing (CEP)">​</a></h3>
<div class="language-java codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-java codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">// Pattern detection with Flink CEP</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.cep.CEP;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.cep.PatternStream;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.cep.pattern.Pattern;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.cep.pattern.conditions.SimpleCondition;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">public class PatternDetectionApp {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    public static void main(String[] args) throws Exception {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        DataStream&lt;LoginEvent&gt; loginEvents = env</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            .addSource(new FlinkKinesisConsumer&lt;&gt;(&quot;login-events&quot;, </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                                                 new LoginEventDeserializer(), </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                                                 kinesisProps));</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        // Define suspicious login pattern</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        Pattern&lt;LoginEvent, ?&gt; suspiciousPattern = Pattern.&lt;LoginEvent&gt;begin(&quot;first&quot;)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            .where(new SimpleCondition&lt;LoginEvent&gt;() {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                @Override</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                public boolean filter(LoginEvent event) {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                    return event.getStatus().equals(&quot;FAILED&quot;);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            })</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            .next(&quot;second&quot;)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            .where(new SimpleCondition&lt;LoginEvent&gt;() {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                @Override</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                public boolean filter(LoginEvent event) {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                    return event.getStatus().equals(&quot;FAILED&quot;);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            })</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            .next(&quot;third&quot;)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            .where(new SimpleCondition&lt;LoginEvent&gt;() {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                @Override</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                public boolean filter(LoginEvent event) {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                    return event.getStatus().equals(&quot;SUCCESS&quot;);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            })</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            .within(Time.minutes(5));</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        // Apply pattern to stream</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        PatternStream&lt;LoginEvent&gt; patternStream = CEP.pattern(</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            loginEvents.keyBy(LoginEvent::getUserId),</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            suspiciousPattern</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        // Extract matches and generate alerts</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        DataStream&lt;SecurityAlert&gt; alerts = patternStream.select(</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            (Map&lt;String, List&lt;LoginEvent&gt;&gt; pattern) -&gt; {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                List&lt;LoginEvent&gt; firstEvents = pattern.get(&quot;first&quot;);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                List&lt;LoginEvent&gt; thirdEvents = pattern.get(&quot;third&quot;);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                return new SecurityAlert(</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                    firstEvents.get(0).getUserId(),</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                    &quot;BRUTE_FORCE_ATTEMPT&quot;,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                    &quot;Multiple failed logins followed by success&quot;,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                    System.currentTimeMillis()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        alerts.addSink(new SecurityAlertSink());</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        env.execute(&quot;Login Pattern Detection&quot;);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="performance-optimization">Performance Optimization<a href="#performance-optimization" class="hash-link" aria-label="Direct link to Performance Optimization" title="Direct link to Performance Optimization">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_aa2m" id="1-application-scaling">1. Application Scaling<a href="#1-application-scaling" class="hash-link" aria-label="Direct link to 1. Application Scaling" title="Direct link to 1. Application Scaling">​</a></h3>
<div class="language-java codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-java codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">// Auto-scaling configuration</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">public class ScalingConfiguration {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    public static void configureAutoScaling(StreamExecutionEnvironment env) {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        // Set parallelism based on throughput</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        env.setParallelism(4);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        // Configure memory</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        Configuration config = new Configuration();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        config.setString(&quot;taskmanager.memory.process.size&quot;, &quot;2g&quot;);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        config.setString(&quot;taskmanager.memory.flink.size&quot;, &quot;1.5g&quot;);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        // Optimize checkpointing</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        env.enableCheckpointing(30000); // 30 seconds</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        env.getCheckpointConfig().setMinPauseBetweenCheckpoints(10000);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        env.getCheckpointConfig().setCheckpointTimeout(60000);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        env.getCheckpointConfig().setMaxConcurrentCheckpoints(1);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        // Configure state backend</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        env.setStateBackend(new RocksDBStateBackend(&quot;s3://checkpoints/flink/&quot;));</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_aa2m" id="2-sql-query-optimization">2. SQL Query Optimization<a href="#2-sql-query-optimization" class="hash-link" aria-label="Direct link to 2. SQL Query Optimization" title="Direct link to 2. SQL Query Optimization">​</a></h3>
<div class="language-sql codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-sql codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">-- Optimized aggregation query</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">CREATE</span><span class="token plain"> STREAM optimized_metrics </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    merchant_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">COUNT</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">as</span><span class="token plain"> transaction_count</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">SUM</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">amount</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">as</span><span class="token plain"> total_amount</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">-- Use approximate functions for better performance</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    APPROX_COUNT_DISTINCT</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">user_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">as</span><span class="token plain"> unique_users</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    ROWTIME_RANGE_START </span><span class="token keyword" style="color:rgb(86, 156, 214)">as</span><span class="token plain"> window_start</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> SOURCE_SQL_STREAM_001</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Filter early to reduce processing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">WHERE</span><span class="token plain"> amount </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">AND</span><span class="token plain"> merchant_id </span><span class="token operator" style="color:rgb(212, 212, 212)">IS</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    merchant_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">-- Use smaller windows for lower latency</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    RANGE_INTERVAL </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;1&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">MINUTE</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Partitioned processing for high throughput</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">CREATE</span><span class="token plain"> STREAM partitioned_processing </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    partition_key</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    event_type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">COUNT</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">as</span><span class="token plain"> event_count</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">AVG</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">processing_time</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">as</span><span class="token plain"> avg_processing_time</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token function" style="color:rgb(220, 220, 170)">MOD</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">ABS</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">HASH_CODE</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">user_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">as</span><span class="token plain"> partition_key</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        event_type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">ROWTIME </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> event_timestamp</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">SECOND</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">as</span><span class="token plain"> processing_time</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        ROWTIME</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> SOURCE_SQL_STREAM_001</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    partition_key</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    event_type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    RANGE_INTERVAL </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;30&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">SECOND</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="monitoring-và-troubleshooting">Monitoring và Troubleshooting<a href="#monitoring-và-troubleshooting" class="hash-link" aria-label="Direct link to Monitoring và Troubleshooting" title="Direct link to Monitoring và Troubleshooting">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_aa2m" id="1-application-metrics">1. Application Metrics<a href="#1-application-metrics" class="hash-link" aria-label="Direct link to 1. Application Metrics" title="Direct link to 1. Application Metrics">​</a></h3>
<div class="language-python codeBlockContainer_fd20 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_z5HD"><pre tabindex="0" class="prism-code language-python codeBlock_PbU4 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_ZkdA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> boto3</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> json</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">KinesisAnalyticsMonitor</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">__init__</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">cloudwatch </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> boto3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">client</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;cloudwatch&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">kinesisanalytics </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> boto3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">client</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;kinesisanalyticsv2&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">get_application_metrics</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> application_name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> start_time</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> end_time</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token triple-quoted-string string" style="color:rgb(206, 145, 120)">&quot;&quot;&quot;Get comprehensive application metrics&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        metrics </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;inputProcessing.DroppedRecords&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;inputProcessing.ProcessedRecords&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;inputProcessing.ProcessedBytes&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;outputDelivery.DeliveredRecords&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;outputDelivery.DeliveryDelay&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;kpu.utilization&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;downtime&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;uptime&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        results </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">for</span><span class="token plain"> metric </span><span class="token keyword" style="color:rgb(86, 156, 214)">in</span><span class="token plain"> metrics</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            response </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">cloudwatch</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">get_metric_statistics</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                Namespace</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;AWS/KinesisAnalytics&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                MetricName</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">metric</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                Dimensions</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;Name&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;Application&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;Value&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> application_name</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                StartTime</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">start_time</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                EndTime</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">end_time</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                Period</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token number" style="color:rgb(181, 206, 168)">300</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                Statistics</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;Average&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;Maximum&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;Sum&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            results</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">metric</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;Datapoints&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> results</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">check_application_health</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> application_name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token triple-quoted-string string" style="color:rgb(206, 145, 120)">&quot;&quot;&quot;Check application health and performance&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        response </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">kinesisanalytics</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">describe_application</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            ApplicationName</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">application_name</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        app_detail </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;ApplicationDetail&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        health_check </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;application_name&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> application_name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;status&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> app_detail</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;ApplicationStatus&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;version&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> app_detail</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;ApplicationVersionId&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;runtime_environment&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> app_detail</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;RuntimeEnvironment&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;last_update&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> app_detail</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;LastUpdateTimestamp&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">isoformat</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;issues&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)"># Check for common issues</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> app_detail</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;ApplicationStatus&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">!=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;RUNNING&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            health_check</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;issues&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">append</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-interpolation string" style="color:rgb(206, 145, 120)">f&quot;Application not running: </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token string-interpolation interpolation">app_detail</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string-interpolation interpolation string" style="color:rgb(206, 145, 120)">&#x27;ApplicationStatus&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-interpolation string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)"># Check KPU utilization</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        kpu_metrics </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">get_recent_kpu_utilization</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">application_name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> kpu_metrics </span><span class="token keyword" style="color:rgb(86, 156, 214)">and</span><span class="token plain"> kpu_metrics </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">80</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            health_check</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;issues&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">append</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string-interpolation string" style="color:rgb(206, 145, 120)">f&quot;High KPU utilization: </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token string-interpolation interpolation">kpu_metrics</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-interpolation string" style="color:rgb(206, 145, 120)">%&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> health_check</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">create_custom_alarms</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> application_name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token triple-quoted-string string" style="color:rgb(206, 145, 120)">&quot;&quot;&quot;Create CloudWatch alarms for the application&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        alarms </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;AlarmName&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:rgb(206, 145, 120)">f&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token string-interpolation interpolation">application_name</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-interpolation string" style="color:rgb(206, 145, 120)">-high-error-rate&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;MetricName&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;inputProcessing.DroppedRecords&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;Threshold&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">100</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;ComparisonOperator&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;GreaterThanThreshold&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;AlarmName&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:rgb(206, 145, 120)">f&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token string-interpolation interpolation">application_name</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-interpolation string" style="color:rgb(206, 145, 120)">-high-kpu-utilization&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;MetricName&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;kpu.utilization&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;Threshold&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">80</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;ComparisonOperator&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;GreaterThanThreshold&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;AlarmName&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:rgb(206, 145, 120)">f&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token string-interpolation interpolation">application_name</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-interpolation string" style="color:rgb(206, 145, 120)">-application-downtime&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;MetricName&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;downtime&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;Threshold&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;ComparisonOperator&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;GreaterThanThreshold&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">for</span><span class="token plain"> alarm </span><span class="token keyword" style="color:rgb(86, 156, 214)">in</span><span class="token plain"> alarms</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            self</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">cloudwatch</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">put_metric_alarm</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                AlarmName</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">alarm</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;AlarmName&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                ComparisonOperator</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">alarm</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;ComparisonOperator&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                EvaluationPeriods</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                MetricName</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">alarm</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;MetricName&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                Namespace</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;AWS/KinesisAnalytics&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                Period</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token number" style="color:rgb(181, 206, 168)">300</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                Statistic</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;Average&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                Threshold</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">alarm</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;Threshold&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                ActionsEnabled</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                AlarmActions</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                    </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;arn:aws:sns:region:account:kinesis-analytics-alerts&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                AlarmDescription</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token string-interpolation string" style="color:rgb(206, 145, 120)">f&#x27;Alarm for </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token string-interpolation interpolation">application_name</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token string-interpolation string" style="color:rgb(206, 145, 120)">&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                Dimensions</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;Name&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;Application&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;Value&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> application_name</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="best-practices">Best Practices<a href="#best-practices" class="hash-link" aria-label="Direct link to Best Practices" title="Direct link to Best Practices">​</a></h2>
<ol>
<li><strong>Application Design</strong>: Design cho fault tolerance và scalability</li>
<li><strong>State Management</strong>: Sử dụng appropriate state backends</li>
<li><strong>Checkpointing</strong>: Configure proper checkpointing intervals</li>
<li><strong>Resource Sizing</strong>: Right-size KPUs based on throughput</li>
<li><strong>Error Handling</strong>: Implement comprehensive error handling</li>
<li><strong>Monitoring</strong>: Set up detailed monitoring và alerting</li>
<li><strong>Testing</strong>: Thorough testing với realistic data volumes</li>
<li><strong>Security</strong>: Implement proper IAM roles và VPC configuration</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_aa2m" id="tích-hợp-với-các-dịch-vụ-aws-khác">Tích hợp với các dịch vụ AWS khác<a href="#tích-hợp-với-các-dịch-vụ-aws-khác" class="hash-link" aria-label="Direct link to Tích hợp với các dịch vụ AWS khác" title="Direct link to Tích hợp với các dịch vụ AWS khác">​</a></h2>
<ul>
<li><strong>Amazon Kinesis Data Streams</strong>: Primary data source</li>
<li><strong>Amazon Kinesis Data Firehose</strong>: Data delivery</li>
<li><strong>Amazon S3</strong>: Reference data và output storage</li>
<li><strong>Amazon DynamoDB</strong>: Real-time lookups và results</li>
<li><strong>AWS Lambda</strong>: Event-driven processing</li>
<li><strong>Amazon SNS</strong>: Real-time notifications</li>
<li><strong>Amazon CloudWatch</strong>: Monitoring và alerting</li>
<li><strong>AWS IAM</strong>: Security và access control</li>
<li><strong>Amazon VPC</strong>: Network isolation</li>
<li><strong>Amazon MSK</strong>: Apache Kafka integration</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/aws-nodes/aws-analytics/19-kinesis-data-analytics.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_t8pj" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_Olft"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/keep-being-human-dev/docs/aws-nodes/aws-analytics/glue/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">AWS Glue</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/keep-being-human-dev/docs/aws-nodes/aws-analytics/kinesis-data-firehose/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Amazon Kinesis Data Firehose</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_ZllA thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#tổng-quan" class="table-of-contents__link toc-highlight">Tổng quan</a></li><li><a href="#chức-năng-chính" class="table-of-contents__link toc-highlight">Chức năng chính</a><ul><li><a href="#1-real-time-stream-processing" class="table-of-contents__link toc-highlight">1. Real-time Stream Processing</a></li><li><a href="#2-multiple-runtime-environments" class="table-of-contents__link toc-highlight">2. Multiple Runtime Environments</a></li><li><a href="#3-data-sources-integration" class="table-of-contents__link toc-highlight">3. Data Sources Integration</a></li><li><a href="#4-output-destinations" class="table-of-contents__link toc-highlight">4. Output Destinations</a></li></ul></li><li><a href="#use-cases-phổ-biến" class="table-of-contents__link toc-highlight">Use Cases phổ biến</a></li><li><a href="#diagram-architecture" class="table-of-contents__link toc-highlight">Diagram Architecture</a><ul><li><a href="#code-để-tạo-diagram" class="table-of-contents__link toc-highlight">Code để tạo diagram:</a></li></ul></li><li><a href="#sql-based-analytics" class="table-of-contents__link toc-highlight">SQL-based Analytics</a><ul><li><a href="#1-stream-processing-với-sql" class="table-of-contents__link toc-highlight">1. Stream Processing với SQL</a></li><li><a href="#2-windowing-functions" class="table-of-contents__link toc-highlight">2. Windowing Functions</a></li><li><a href="#3-reference-data-joins" class="table-of-contents__link toc-highlight">3. Reference Data Joins</a></li></ul></li><li><a href="#apache-flink-applications" class="table-of-contents__link toc-highlight">Apache Flink Applications</a><ul><li><a href="#1-flink-datastream-api" class="table-of-contents__link toc-highlight">1. Flink DataStream API</a></li><li><a href="#2-complex-event-processing-cep" class="table-of-contents__link toc-highlight">2. Complex Event Processing (CEP)</a></li></ul></li><li><a href="#performance-optimization" class="table-of-contents__link toc-highlight">Performance Optimization</a><ul><li><a href="#1-application-scaling" class="table-of-contents__link toc-highlight">1. Application Scaling</a></li><li><a href="#2-sql-query-optimization" class="table-of-contents__link toc-highlight">2. SQL Query Optimization</a></li></ul></li><li><a href="#monitoring-và-troubleshooting" class="table-of-contents__link toc-highlight">Monitoring và Troubleshooting</a><ul><li><a href="#1-application-metrics" class="table-of-contents__link toc-highlight">1. Application Metrics</a></li></ul></li><li><a href="#best-practices" class="table-of-contents__link toc-highlight">Best Practices</a></li><li><a href="#tích-hợp-với-các-dịch-vụ-aws-khác" class="table-of-contents__link toc-highlight">Tích hợp với các dịch vụ AWS khác</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/keep-being-human-dev/docs/intro/">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink__HqX"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink__HqX"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink__HqX"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/keep-being-human-dev/blog/">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink__HqX"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>